(this["webpackJsonp@datapali/web"]=this["webpackJsonp@datapali/web"]||[]).push([[0],{534:function(e,t,n){e.exports=n(905)},539:function(e,t,n){},543:function(e,t,n){},793:function(e,t,n){},905:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(10),i=n.n(r),l=(n(539),n(26)),s=n(25),c=n(35),u=n(34),d=n(36),p=n(30),m=n(477),h=n(281),f=n(62),v=n(108),g=n(104),y=n(448),b=(n(543),n(50)),E=n(913),C=n(196),O="add-filled-form",S="add-available-form",k="replace-available-forms",N="delete-available-form",w="add-item-to-root-form",I="move-item-in-root-form",T="delete-item-in-root-form",j="set-user",F="logout";function A(e){return{type:j,payload:e}}var x=n(918),q=n(14),R=x.a.confirm;var D=n(263),M=n(357),G=n(452),P=n.n(G),V=n(445),L=n(117),Q={byId:{},ids:[]};var U,_,B=n(90),J=Object.prototype.hasOwnProperty,$={byId:{},ids:[]};!function(e){e.SURVEYOR="surveyor",e.ADMIN="admin"}(U||(U={})),function(e){e.DARK="dark",e.LIGHT="light"}(_||(_={}));var H={filledForms:[],availableForms:[],firstName:"",id:"",lastName:"",token:"",accountType:U.SURVEYOR,createdForms:[]};var K,z=Object(D.a)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:var n=t.payload;return Object(B.a)({},e,{},n);default:return e}},rootForms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(L.a)(e,(function(e){var n=t.payload;e.ids.includes(n.id)||e.ids.push(n.id),e.byId[n.id]=n.root}));case w:return Object(L.a)(e,(function(e){var n=t.payload,a=n.item,o=n.parentId,r=n.rootId,i=e.byId[r];if(!i)throw new Error("Could not find the root");i[a.id]=a,J.call(i[o],"childNodes")&&(i[o].childNodes=a.id)}));case T:return Object(L.a)(e,(function(e){var n=t.payload,a=n.rootId,o=n.itemId,r=n.parentId,i=e.byId[a];if(!i)throw new Error("Could not find the root");delete i[o];var l=i[r].childNodes.slice(0),s=l.findIndex((function(e){return e===o}));l.splice(0,s),i[r].childNodes=l}));case I:return Object(L.a)(e,(function(e){var n=t.payload,a=n.rootId,o=n.itemId,r=n.parentId,i=n.newParentId,l=e.byId[a];if(!l)throw new Error("Could not find the root");var s=l[r].childNodes.slice(0),c=s.findIndex((function(e){return e===o}));s.splice(0,c),l[r].childNodes=s,l[i].childNodes.push(o)}));case k:var n=t.payload;return Object(B.a)({},e,{byId:n.roots,ids:Object.keys(n)});case N:default:return e}},filledForms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:var n=t.payload,a=n.id,o=n.filledForm;return Object(L.a)(e,(function(e){e.byId[a]=o,e.ids.includes(o.id)||e.ids.push(o.id)}));default:return e}},form:V.a}),Y={rootForms:$,user:H,filledForms:Q,form:{}},Z={key:"root",storage:P.a},W=Object(M.a)(Z,(function(e,t){return t.type===F&&(e=Y),z(e,t)})),X=Object(D.b)(W),ee=Object(M.b)(X),te=Object(f.b)((function(e,t){return{}}),(function(e){return{onLogoutClick:function(){e({type:F,payload:void 0}),ee.purge()}}}))((function(e){var t=function(){e.onLogoutClick&&e.onLogoutClick()};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(q.a,{style:{fontSize:20,color:"black"},className:"trigger",type:e.isSidebarCollapsed?"menu-unfold":"menu-fold",onClick:function(t){return e.setSidebarCollapsed(!e.isSidebarCollapsed)}})),o.a.createElement("div",null,o.a.createElement(q.a,{onClick:function(){return e=t,void R({title:"Sign Out",content:"Are you sure you want to sign out?",onOk:function(){e()},onCancel:function(){}});var e},style:{color:"black",fontSize:20,alignSelf:"flex-end"},type:"logout"})))})),ne=n(112),ae=n.n(ne),oe=function(){function e(){Object(l.a)(this,e),this.literals=Array()}return Object(s.a)(e,[{key:"setLiterals",value:function(e){return this.literals=e,this}},{key:"getClause",value:function(){var e=this,t="";return this.literals.forEach((function(n,a){t+="l".concat(a).concat(a===e.literals.length-1?n.followingOperator:"")})),t}},{key:"addLiteral",value:function(e){this.literals.push(e),console.log(this.literals)}},{key:"deleteLiteral",value:function(e){return this.literals.splice(e,1),this}},{key:"Literals",get:function(){return this.literals}}],[{key:"fromJSON",value:function(t){if(!t)return new e;var n=new e,a=t.literals;return n.setLiterals(a),n}},{key:"toJSON",value:function(e){if(e)return{literals:JSON.parse(JSON.stringify(e.literals))}}},{key:"checkIfValid",value:function(e){if(!e.literals)return!1;var t=!0;return e.literals.forEach((function(e){Object.values(e).every((function(e){return!ae.a.isNil(e)}))||(t=!1)})),t}},{key:"Clone",value:function(t){return new e}}]),e}();function re(e){if(e)return{name:e.name,ofType:le(e.ofType)}}function ie(e){return{name:e.name,ofType:re(e.ofType)}}function le(e){if(e)return{name:e.name,ofType:le(e.ofType)}}function se(e){return{name:e.name,ofType:le(e.ofType)}}!function(e){e.OR="||",e.AND="&"}(K||(K={}));var ce=function(){function e(){Object(l.a)(this,e),this.optionsMap={},this.optionGroupMap={},this.options=[],this.opt_count=0,this.group_count=0}return Object(s.a)(e,[{key:"addOption",value:function(e){e||(e={id:"opt-"+this.opt_count,value:void 0,groupName:void 0}),this.optionsMap[e.id]=e;var t=e.groupName;if(t){var n=this.optionGroupMap[t];n||(n={id:"opt-grp-"+this.group_count,name:t,appearingCondition:void 0,members:[e]},this.optionGroupMap[t]=n,this.group_count++);var a=null;e&&e.id&&(a=n.members.find((function(t){return!!e&&t.id===e.id}))),a||n.members.push(e)}return this.opt_count++,this}},{key:"addGroup",value:function(e){var t={id:"opt-grp"+this.group_count,name:e||"group-".concat(this.group_count),appearingCondition:void 0,members:[]};return this.optionGroupMap[t.name]=t,this.group_count++,t}},{key:"setValueForOption",value:function(e,t){var n=this.optionsMap[e];return n&&(n.value=t),this}},{key:"deleteOption",value:function(e){var t=this.optionsMap[e];if(t){delete this.optionsMap[e];var n=t.groupName;if(n){var a=this.optionGroupMap[n];if(a){var o=a.members.findIndex((function(t){return t.id===e}));o>-1&&a.members.splice(o,1)}}}return this}},{key:"assignOptionToGroup",value:function(e,t){var n=this,a=this.optionGroupMap[t];a||(a=this.addGroup(t),this.optionGroupMap[a.name]=a);for(var o=function(t){var o=e[t],r=n.optionsMap[o],i=r.groupName&&n.optionGroupMap[r.groupName];if(a.members.find((function(e){return e.id===o})))return"continue";if(i){var l=i.members.findIndex((function(e){return e.id===r.id}));l>-1&&i.members.splice(l,1)}r.groupName=a.name,a.members.push(r)},r=0;r<e.length;r++)o(r);return this}},{key:"setConditionForOption",value:function(e,t){var n=this.optionsMap[e];return n&&(n.appearingCondition=t),this}},{key:"setConditionForGroup",value:function(e,t){var n=this.optionGroupMap[e];return n&&(n.appearingCondition=t),this}},{key:"unassignGroup",value:function(e){var t=this;e.forEach((function(e){var n=t.optionsMap[e],a=n.groupName;if(n&&a){var o=t.optionGroupMap[a];if(o){var r=o.members.findIndex((function(t){return t.id===e}));o.members.splice(r,1)}}n&&(n.groupName=void 0)}))}},{key:"changeGroupName",value:function(e,t){var n=this,a=this.optionGroupMap[e],o=a.members.map((function(e){return e.id}));if(o&&o.forEach((function(e){var a=n.optionsMap[e];a&&(a.groupName=t)})),a){a.name=t;var r=ae.a.clone(a);delete this.optionGroupMap[e],this.optionGroupMap[t]=r}}},{key:"deleteGroup",value:function(e){var t=this,n=this.optionGroupMap[e];if(!n)return this;var a=n.members.map((function(e){return e.id}));a&&a.forEach((function(e){var n=t.optionsMap[e];n&&(n.groupName=void 0)})),delete this.optionGroupMap[e]}},{key:"setOptionTypeFor",value:function(e,t){var n=this.optionsMap[e];n&&(n.type=t,n.value=void 0)}},{key:"SortedOptions",get:function(){var e=Object.values(this.optionsMap).filter((function(e){return!e.groupName}));return{groups:Object.values(this.optionGroupMap),rootOptions:e}}}],[{key:"toJSON",value:function(e){return{optionsMap:e&&e.optionsMap?ae.a.mapValues(e.optionsMap,(function(e){return ue(e)})):{},optionGroupMap:e&&e.optionGroupMap?ae.a.mapValues(e.optionGroupMap,(function(e){return function(e){return{id:e.id,name:e.name,appearingCondition:oe.toJSON(e.appearingCondition),members:e.members.map((function(e){return ue(e)}))}}(e)})):{}}}},{key:"fromJSON",value:function(t){var n=new e;return n.optionsMap=t.optionsMap?ae.a.mapValues(t.optionsMap,(function(e){return function(e){var t={groupName:e.groupName,appearingCondition:oe.fromJSON(e.appearingCondition),id:e.id,value:e.value};e.type&&(t.type=se(e.type));return t}(e)})):{},n.optionGroupMap=t.optionGroupMap?ae.a.mapValues(t.optionGroupMap,(function(e){return{id:e.id,name:e.name,appearingCondition:oe.fromJSON(e.appearingCondition),members:e.members.map((function(e){return n.optionsMap[e.id]}))}})):{},n}}]),e}();function ue(e){return{appearingCondition:oe.toJSON(e.appearingCondition),type:e.type?ie(e.type):void 0,id:e.id,value:e.value,groupName:e.groupName}}var de,pe,me,he;!function(e){e.Less_Than_Or_Equal="<=",e.Greater_Than_Or_Equal=">=",e.Less_Than="<",e.Greater_Than=">",e.Equal="=="}(de||(de={})),function(e){e.String="String",e.Boolean="Boolean",e.Date="Date",e.Time="Time",e.Number="Number",e.Select="Select"}(pe||(pe={})),function(e){e.String="string",e.html="html"}(me||(me={})),function(e){e.BOOLEAN="boolean",e.STRING="string",e.DATE="date",e.TIME="time",e.NUMBER="number",e.RANGE="range",e.SELECT="select",e.GEOLOCATION="geolocation"}(he||(he={}));var fe=function(){function e(){Object(l.a)(this,e),this.consts={},this.count=0}return Object(s.a)(e,[{key:"getConstant",value:function(e){return ae.a.cloneDeep(this.consts[e])}},{key:"addConstant",value:function(e){return e||(e={name:"",id:"constant-"+this.count,type:void 0,value:""}),this.consts[e.id]=e,this}},{key:"removeConstant",value:function(e){return this.consts[e]&&delete this.consts[e],this}},{key:"ConstantsArray",get:function(){return Object.values(this.consts)}}],[{key:"fromJSON",value:function(e){}},{key:"toJSON",value:function(e){}}]),e}();function ve(e){return{isEnabled:e.isEnabled,condition:oe.toJSON(e.condition),duplicateTimes:{value:e.duplicateTimes.value,type:e.duplicateTimes.type}}}function ge(e){return e.slice(1).map((function(e){return e+1})).join(".")}function ye(e){e||(e="");var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e+(t()+t()+"-")+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}var be=function(){function e(){Object(l.a)(this,e),this.content=[],this.customId="",this.autoAnswer={isEnabled:!1,answeringConditions:[]},this.options=new ce,this.id=ye("q-"),this.questionContent={content:"",type:me.String}}return Object(s.a)(e,[{key:"updateFromQuestion",value:function(e){return this.isRequired=e.isRequired,this.appearingCondition=e.appearingCondition,this.questionContent=e.questionContent,this.autoAnswer=e.autoAnswer,this.options=e.options,this.answerType=e.answerType,this.customId=e.customId,this.id=e.id,this}},{key:"setIsRequired",value:function(e){return this.isRequired=e,this}},{key:"setAppearingCondition",value:function(e){return this.appearingCondition=e,this}},{key:"setAutoAnswer",value:function(e){return this.autoAnswer=e,this}},{key:"setQuestionContent",value:function(e){return this.questionContent=e,this}},{key:"setCreationDate",value:function(e){return this.creationDate=e||(new Date).getTime(),this}},{key:"setAutoAnswerEnabled",value:function(e){return this.autoAnswer.isEnabled=e||!0,this}},{key:"addAutoAnswerCondition",value:function(e){return this.autoAnswer.answeringConditions.push(e),this}},{key:"setAnswerType",value:function(e){return this.answerType=e,this}},{key:"setOptions",value:function(e){return this.options=e,this}}],[{key:"toJSON",value:function(e){return{id:e.id,isRequired:e.isRequired,appearingCondition:oe.toJSON(e.appearingCondition),questionContent:{content:e.questionContent.content,type:e.questionContent.type},autoAnswer:Ee(e.autoAnswer),options:ce.toJSON(e.options),answerType:e.answerType?ie(e.answerType):void 0,customId:e.customId}}},{key:"fromJSON",value:function(t){var n=new e;return n.id=t.id,n.isRequired=t.isRequired,n.appearingCondition=oe.fromJSON(t.appearingCondition),n.questionContent=t.questionContent,t.options&&(n.options=ce.fromJSON(t.options)),t.answerType&&(n.answerType=se(t.answerType)),t.autoAnswer&&(n.autoAnswer=function(e){return{isEnabled:e.isEnabled,answeringConditions:e.answeringConditions.map((function(e){return function(e){return{condition:oe.fromJSON(e.condition),ifFalse:e.ifFalse,ifTrue:e.ifTrue}}(e)}))}}(t.autoAnswer)),n.customId=t.customId||"",n}}]),e}();function Ee(e){if(e)return{isEnabled:e.isEnabled,answeringConditions:e.answeringConditions.map((function(e){return function(e){return{condition:oe.toJSON(e.condition),ifTrue:e.ifTrue,ifFalse:e.ifFalse}}(e)}))}}var Ce,Oe=function(){function e(){Object(l.a)(this,e),this.customId="",this.id=ye("ss-"),this.duplicatingSettings={condition:void 0,isEnabled:!1,duplicateTimes:{value:"",type:"number"}},this.content=[],this.appearingCondition=new oe}return Object(s.a)(e,[{key:"setID",value:function(e){return this.id=e,this}},{key:"setName",value:function(e){return this.name=e,this}},{key:"setContent",value:function(e){return this.content=e,this}},{key:"addContent",value:function(e){return this.content.push(e),this}},{key:"deleteContent",value:function(e){var t=this.content.findIndex((function(t){return t.id===e}));t>-1&&this.content.splice(t,1)}},{key:"setDuplicatingSettings",value:function(e){return this.duplicatingSettings=e,this}}],[{key:"toJSON",value:function(t){return{name:t.name,id:t.id,appearingCondition:oe.toJSON(t.appearingCondition),customId:t.customId,content:t.content.map((function(t){return t instanceof e?e.toJSON(t):t instanceof be?be.toJSON(t):void 0})),duplicatingSettings:ve(t.duplicatingSettings)}}}]),e}(),Se=n(73),ke=n.n(Se),Ne=function(){function e(){Object(l.a)(this,e),this.questions={},this.sections={},this.content=[],this.name="",this.id=ye("root-")}return Object(s.a)(e,[{key:"setName",value:function(e){return this.name=e,this}},{key:"descendants",value:function(e){!function t(n,a){for(var o=0;o<n.content.length;o++){var r=n.content[o];if(r){var i=e(r,a.concat(o),n);r instanceof Oe&&(Object(ne.isNil)(i)||!0===i)&&t(r,a.concat(o))}}}(this,[0])}},{key:"addQuestion",value:function(t,n){n||(n=[new be]);for(var a=e.getFromPath(t,[this]),o=0;o<n.length;o++){var r=n[o];if(this.questions[r.id])throw new Error("Question id conflict");this.questions[r.id]=r,!a||a instanceof be||a.content.push(r)}return this}},{key:"addSection",value:function(t,n){n||(n=[new Oe]);for(var a=e.getFromPath(t,[this]),o=0;o<n.length;o++){var r=n[o];if(this.questions[r.id])throw new Error("Section id conflict");this.sections[r.id]=r,!a||a instanceof be||a.content.push(r)}return this}},{key:"removeQuestion",value:function(t,n){var a=e.getFromPath(n.slice(0,n.length-1),[this]);if(a&&!(a instanceof be)){var o=a.content.findIndex((function(e){return e.id===t}));o>-1&&(a.content.splice(o,1),delete this.questions[t])}return this}},{key:"removeSection",value:function(t,n){var a=e.getFromPath(n.slice(0,n.length-1),[this]);if(a&&!(a instanceof be)){var o=a.content.findIndex((function(e){return e.id===t}));o>-1&&(a.content.splice(o,1),delete this.sections[t])}return this}},{key:"moveItem",value:function(t,n){var a=e.getFromPath(t,[this]),o=n.slice(0,n.length-1),r=t.slice(0,t.length-1),i=e.getFromPath(o,[this]),l=e.getFromPath(r,[this]);if(l&&i&&a){var s=l.content.findIndex((function(e){return e.id===a.id}));if(s>-1&&!(l instanceof be)){var c=l.content.splice(s,1);if(!(i instanceof be)){var u=n[n.length-1];c[0]instanceof Oe?i.content.splice(u,0,this.sections[c[0].id]):c[0]instanceof be&&i.content.splice(u,0,this.questions[c[0].id])}return this}}}},{key:"Iterator2",value:ke.a.mark((function t(n,a,o){var r,i,l,s,c,u,d,p,m,h,f,v,g,y;return ke.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==n.length){t.next=2;break}return t.abrupt("return",!0);case 2:if(!(r=e.getFromPath(n,[this]))||r instanceof be){t.next=75;break}case 4:if(!(a<r.content.length)){t.next=46;break}if(!((i=r.content[a])instanceof be)){t.next=13;break}if(o!==Ce.QUESTION&&o){t.next=10;break}return t.next=10,{path:n.concat(a),data:i};case 10:a++,t.next=44;break;case 13:if(!(i instanceof Oe)){t.next=44;break}if(o!==Ce.SECTION&&o){t.next=17;break}return t.next=17,{path:n.concat(a),data:i};case 17:a++,l=!0,s=!1,c=void 0,t.prev=21,u=this.Iterator2(n.concat(a),0,o)[Symbol.iterator]();case 23:if(l=(d=u.next()).done){t.next=30;break}return p=d.value,t.next=27,p;case 27:l=!0,t.next=23;break;case 30:t.next=36;break;case 32:t.prev=32,t.t0=t.catch(21),s=!0,c=t.t0;case 36:t.prev=36,t.prev=37,l||null==u.return||u.return();case 39:if(t.prev=39,!s){t.next=42;break}throw c;case 42:return t.finish(39);case 43:return t.finish(36);case 44:t.next=4;break;case 46:if(!(n&&n.length>0)){t.next=74;break}a=n[n.length-1]+1,m=!0,h=!1,f=void 0,t.prev=51,v=this.Iterator2(n,a,o)[Symbol.iterator]();case 53:if(m=(g=v.next()).done){t.next=60;break}return y=g.value,t.next=57,y;case 57:m=!0,t.next=53;break;case 60:t.next=66;break;case 62:t.prev=62,t.t1=t.catch(51),h=!0,f=t.t1;case 66:t.prev=66,t.prev=67,m||null==v.return||v.return();case 69:if(t.prev=69,!h){t.next=72;break}throw f;case 72:return t.finish(69);case 73:return t.finish(66);case 74:return t.abrupt("return",!0);case 75:case"end":return t.stop()}}),t,this,[[21,32,36,44],[37,,39,43],[51,62,66,74],[67,,69,73]])}))}],[{key:"getFromPath",value:function(t,n){var a=n[t[0]];return 1===t.length?a:a.content?e.getFromPath(t.slice(1),a.content):void 0}},{key:"Entries",value:function(t,n,a,o){var r=[],i=[],l=n.slice(0);r.push({path:n,startIndex:a});for(var s=0;s<n.length-1;s++)r.push({path:l.slice(0,l.length-1),startIndex:l[l.length-1]+1}),l.pop();for(;r.length>0;){var c=r.shift();if(c){var u=e.getFromPath(c.path,[t]);if(u)for(var d=c.startIndex;d<u.content.length;d++){var p=u.content[d];p instanceof be?o&&o!==Ce.QUESTION||i.push({path:c.path.concat(d),data:p}):(o&&o!==Ce.SECTION||i.push({path:c.path.concat(d),data:p}),r.push({path:c.path.concat(d),startIndex:0}))}}}return i}},{key:"toJSON",value:function(e){return{id:e.id,name:e.name,content:e.content.map((function(e){return e instanceof Oe?Oe.toJSON(e):e instanceof be?be.toJSON(e):void 0}))}}},{key:"fromJSON",value:function(t){var n=new e;n.id=t.id,n.name=t.name;var a=[0],o=function e(t,a,o){if(t.hasOwnProperty("content")){var r=new Oe;r.id=t.id,r.name=t.name,r.customId=t.customId||"",t.customId&&(r.customId=t.customId),t.appearingCondition&&(r.appearingCondition=oe.fromJSON(t.appearingCondition)),r.duplicatingSettings=function(e){return{isEnabled:e.isEnabled,duplicateTimes:{value:e.duplicateTimes.value,type:e.duplicateTimes.type},condition:oe.fromJSON(e.condition)}}(t.duplicatingSettings),n.addSection(a,[r]),t.content.forEach((function(t,n){return e(t,a.concat(o),n)}))}else{var i=be.fromJSON(t);n.addQuestion(a,[i])}};return t.content&&t.content.forEach((function(e,t){return o(e,a,t)})),n}}]),e}();!function(e){e[e.QUESTION=1]="QUESTION",e[e.SECTION=2]="SECTION"}(Ce||(Ce={}));var we=n(911),Ie=n(924),Te=n(920),je=n(928),Fe=n(476),Ae=n.n(Fe),xe=n(54),qe=n(91),Re=n(921),De=n(282),Me=n(916),Ge=n(478),Pe=n(85),Ve=n(917),Le=n(52),Qe=n.n(Le),Ue=n(455),_e=n.n(Ue);function Be(){var e=Object(xe.a)(["\nmutation InitDB($formId:String!){\n    initDbFor(formId:$formId)\n    {\n      message\n    }\n  }"]);return Be=function(){return e},e}function Je(){var e=Object(xe.a)(["\nquery RunAggregation($formId: String!, $query: String!){\n    runAggregationOn(formId:$formId, query:$query)\n  }\n"]);return Je=function(){return e},e}function $e(){var e=Object(xe.a)(["\nquery RunQuery($formId: String!, $query: String!){\n    runQueryOn(formId:$formId, query:$query)\n  }\n"]);return $e=function(){return e},e}var He=Qe()($e()),Ke=Qe()(Je()),ze=(Qe()(Be()),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).queryInput=void 0,n.client=void 0,n.handleModeChange=function(e){n.setState({mode:e.target.value})},n.validate=function(){},n.runQuery=function(){var e;return ke.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e=n.queryInput.state.value,n.client.mutate({mutation:"query"===n.state.mode?He:Ke,variables:{formId:n.props.formId,query:e}}).then((function(e){console.log(e);var t="query"===n.state.mode?e.data.runQueryOn:e.data.runAggregationOn;n.setState({results:JSON.parse(t)})})).catch((function(e){Re.a.error("Invalid query or database has not been initialized")}));case 2:case"end":return t.stop()}}))},n.state={mode:"query",results:""},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(qe.a,null,(function(t){return e.client=t,o.a.createElement("div",null,o.a.createElement(De.a.Group,{value:e.state.mode,onChange:e.handleModeChange},o.a.createElement(De.a.Button,{value:"query"},"Query"),o.a.createElement(De.a.Button,{value:"aggregation"},"Aggregation")),o.a.createElement(Me.a.Item,null,o.a.createElement(Ge.a.TextArea,{rows:10,ref:function(t){return e.queryInput=t}})),o.a.createElement(Pe.a,{style:{width:"100%"},type:"primary",icon:"play-circle",onClick:e.runQuery},"Execute"),o.a.createElement(we.a,null),o.a.createElement("div",null,o.a.createElement(Ve.a.Title,{level:4},"Results"),e.state.results&&o.a.createElement(Ie.a,null,o.a.createElement("code",null,_e()(e.state.results,{highlight:!0,indent:4})))))}))}}]),t}(a.Component)),Ye=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(ze,{formId:"root-53c37497-3808-cfd8-c886-1361dbaab171",onQuerySuccess:function(e){return console.log(e)}}))}}]),t}(a.Component),Ze=n(149),We=n(60),Xe=n(271),et=n(925),tt=n(912),nt=n(922),at=n(464),ot=n(291);function rt(){var e=Object(xe.a)(["\nquery GetFilledFormsPaged($pagination: PaginationInput!) {\n    getFilledForms(pagination: $pagination) {\n      totalCount\n      forms {\n        id\n        completedDate\n        filledBy {\n          firstName\n          lastName\n          email\n        }\n        formId\n      }\n    }\n  }\n  "]);return rt=function(){return e},e}var it=Qe()(rt());var lt=n(154),st=n(31),ct=n.n(st),ut=n(74),dt=n(465),pt=n(184),mt=n(467),ht=n.n(mt);function ft(e){var t=document.getElementById("dp-modal");t||((t=document.createElement("div")).setAttribute("id","dp-modal"),document.body.appendChild(t)),i.a.render(e,t)}function vt(){var e=document.getElementById("dp-modal");e&&i.a.unmountComponentAtNode(e)}var gt=n(4);function yt(e){e||(e="");var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e+(t()+t()+"-")+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}var bt,Et=n(926),Ct=n(222),Ot=n(927),St=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"parseRangeValue",value:function(e){var t=e.split("-");return{min:t[0],max:t[1]}}},{key:"handleInputChange",value:function(e){var t=e.min+"-"+e.max;switch(this.props.type&&this.props.type.name){case he.TIME:case he.DATE:case he.NUMBER:default:this.props.onChange&&this.props.onChange(t)}}},{key:"render",value:function(){var e=this,t=null,n=this.props.type?this.props.type.name:void 0,a=this.parseRangeValue(this.props.value);switch(n){case he.TIME:t=o.a.createElement(It,{range:a,onChange:this.handleInputChange});break;case he.DATE:var r=a.min?new Date(a.min):void 0,i=a.max?new Date(a.max):void 0;t=o.a.createElement(Et.a,{shortcuts:!1,defaultValue:[r,i],onChange:function(t){return e.handleInputChange({min:t[0]?t[0].toString():"",max:t[1]?t[1].toString():""})}});break;case he.NUMBER:t=o.a.createElement(Nt,{range:a,onChange:function(t){return e.handleInputChange}})}return t}}]),t}(o.a.Component),kt={range:{min:"",max:""},onChange:function(){}},Nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,t=Object(a.useState)(e?e.range.min:""),n=Object(b.a)(t,2),r=n[0],i=n[1],l=Object(a.useState)(e?e.range.max:""),s=Object(b.a)(l,2),c=s[0],u=s[1];return o.a.createElement(lt.b,null,o.a.createElement("input",{className:"form-control",defaultValue:e&&e.range.min&&e.range.min.toString(),onChange:function(t){i(t.target.value),e&&e.onChange&&e.onChange({min:r,max:c})},placeholder:"Minimum",id:"numberRange-min",type:"number"}),o.a.createElement(lt.f,null),o.a.createElement("input",{className:"form-control",defaultValue:e&&e.range.max&&e.range.max.toString(),onChange:function(t){u(t.target.value),e&&e.onChange&&e.onChange({min:r,max:c})},placeholder:"Maximum",id:"numberRange-max",type:"number"}))},wt={range:{min:"Sat Aug 31 2019 13:35:27 GMT-0230 (Newfoundland Daylight Time",max:"Sat Aug 31 2019 13:35:27 GMT-0230 (Newfoundland Daylight Time"},onChange:function(){}},It=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=Object(a.useState)(e?e.range.min:void 0),n=Object(b.a)(t,2),r=n[0],i=n[1],l=Object(a.useState)(e?e.range.max:void 0),s=Object(b.a)(l,2),c=s[0],u=s[1];return console.log(c),console.log(r),o.a.createElement(lt.b,null,o.a.createElement(Ct.a,{precision:Ct.b.MINUTE,useAmPm:!0,defaultValue:r?new Date(r):void 0,onChange:function(t){i(t.toLocaleDateString()),e.onChange&&e.onChange({min:r,max:c})}}),o.a.createElement(lt.f,null),o.a.createElement(Ct.a,{precision:Ct.b.MINUTE,useAmPm:!0,defaultValue:c?new Date(c):void 0,onChange:function(t){u(t.toLocaleDateString()),e.onChange({min:r,max:c})}}))},Tt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,null,[{key:"defaultProps",get:function(){return{defaultValue:"",onChange:function(e){console.log(e)},type:{name:he.STRING}}}}]),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=null;switch(this.props.type.name){case he.NUMBER:t=o.a.createElement(lt.n,{defaultValue:this.props.defaultValue,className:"form-control",type:"number",onChange:function(t){e.props.onChange&&e.props.onChange({value:t.target.value})}});break;case he.SELECT:t=o.a.createElement(jt,{type:this.props.type.ofType,defaultValue:this.props.defaultValue,options:this.props.options,onChange:function(t){e.props.onChange&&e.props.onChange(t)}});break;case he.BOOLEAN:var n=[{value:"true",label:"YES"},{value:"false",label:"No"}],a=n.find((function(t){return t.value===e.props.defaultValue}));t=o.a.createElement(ut.a,{styles:Mt,defaultValue:a,options:n,onChange:function(t){e.props.onChange&&e.props.onChange({value:t.value})}});break;case he.DATE:var r=this.props.defaultValue?new Date(this.props.defaultValue):void 0;t=o.a.createElement(Ot.a,{formatDate:function(e){return e.toLocaleDateString()},parseDate:function(e){return new Date(e)},closeOnSelection:!0,defaultValue:r,onChange:function(t){e.props.onChange&&e.props.onChange({value:t.toLocaleDateString()})}});break;case he.RANGE:this.props.type.ofType&&(t=o.a.createElement(St,{value:this.props.defaultValue,type:this.props.type.ofType,onChange:function(t){e.props.onChange&&e.props.onChange({value:t})}}));break;case he.STRING:t=o.a.createElement(lt.n,{className:"form-control",type:"text",defaultValue:this.props.defaultValue,onChange:function(t){e.props.onChange&&e.props.onChange({value:t.target.value})}});break;case he.TIME:var i=this.props.defaultValue?new Date(this.props.defaultValue):void 0;t=o.a.createElement(Ct.a,{precision:Ct.b.MINUTE,useAmPm:!0,defaultValue:i,onChange:function(t){e.props.onChange&&e.props.onChange({value:t.toString()})}})}return t}}]),t}(o.a.Component),jt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleChange",value:function(e){this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=[];if(this.props.options){var t,n=this.props.options.SortedOptions,a=n.rootOptions,r=n.groups,i=[];r&&r.length>0&&(i=r.map((function(e){return{label:e.name,options:e.members.map((function(e){return{label:e.value,value:e.id}}))}}))),t=a.map((function(e){return{label:e.value,value:e.id}})),e=[].concat(Object(Ze.a)(i),Object(Ze.a)(t))}var l=function(e,t){for(var n=null,a=0;a<e.length;a++){var o=e[a];if(o.options&&o.options.length>0){if(n=o.options.find((function(e){return e.value===t})))break}else if(n=o&&o.value===t?o:void 0)break}return n}(e,this.props.defaultValue);return o.a.createElement(ut.a,{styles:Mt,options:e,onChange:this.handleChange.bind(this),defaultValue:l})}}]),t}(o.a.Component);!function(e){e[e.QuestionRef=1]="QuestionRef",e[e.ComparisonOperator=2]="ComparisonOperator",e[e.ComparisonValue=3]="ComparisonValue",e[e.FollowingOperator=4]="FollowingOperator"}(bt||(bt={}));var Ft=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={literals:n.props.condition?n.props.condition.literals:[]},n.columns=[{dataField:"id",text:"Literal ID"},{dataField:"questionRef",text:"Question Reference"},{dataField:"comparisonOperator",text:"Comparison Operator"},{dataField:"comparisonValue",text:"Comparison Value"},{dataField:"followingOperator",text:"Following Operator"}],n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.setLiteralsSetter&&this.props.setLiteralsSetter(this.setLiterals.bind(this))}},{key:"setLiterals",value:function(e){this.setState({literals:e})}},{key:"addLiteral",value:function(e){var t=this;e||(e={literalId:yt("lit-"),questionRef:void 0,comparisonOperator:void 0,comparisonValue:void 0,followingOperator:void 0}),this.setState((function(t){var n=ct.a.clone(t.literals);return e&&n.push(e),{literals:n}}),(function(){t.props.onChange&&t.props.onChange(t.state.literals)}))}},{key:"moveLiteralUp",value:function(e){this.setState((function(t){var n=ct.a.clone(t.literals),a=function(e,t){var n;return((e-1)%(n=t)+n)%n}(e,n.length),o=[n[a],n[e]];return n[e]=o[0],n[a]=o[1],{literals:n}}),this.forceUpdate.bind(this))}},{key:"handleDataChange",value:function(e,t,n){var a=this;this.setState((function(a){var o=ct.a.clone(a.literals),r=o[e];switch(t){case bt.QuestionRef:r.questionRef=n&&n.value?n.value:void 0;break;case bt.ComparisonOperator:var i,l;for(i in de)if(de[i]===n.value){l=i,r.comparisonOperator=de[l];break}break;case bt.ComparisonValue:var s={content:n.value,type:me.String};r.comparisonValue=s;break;case bt.FollowingOperator:r.followingOperator=n.value===K.AND?K.AND:K.OR}return{literals:o}}),(function(){a.props.onChange&&a.props.onChange(a.state.literals)}))}},{key:"getQuestion",value:function(e){return e&&this.props.definedQuestions&&!ct.a.isEmpty(this.props.definedQuestions)?this.props.definedQuestions[e]:null}},{key:"removeLiteral",value:function(e){var t=this;this.setState((function(t){var n=ct.a.clone(t.literals);return n.splice(e,1),{literals:n}}),(function(){t.props.onChange&&t.props.onChange(t.state.literals)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement(lt.l,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{key:"th-first"},""),this.columns.map((function(e,t){return o.a.createElement("th",{key:t},e.text)})),o.a.createElement("th",{key:"th-last"},""))),o.a.createElement("tbody",null,this.state.literals.map((function(t,n){var a=e.props.definedQuestions?Object.values(e.props.definedQuestions).map((function(e){return{value:e.id,label:e.questionContent.content}})):[],r=o.a.createElement(ut.a,{key:"literalq-".concat(n,"-").concat(t.literalId),styles:Mt,options:a,value:a.find((function(e){return e.value===t.questionRef})),onChange:function(t){return e.handleDataChange(n,bt.QuestionRef,t)}}),i=function(e){var t=Object.values(de);switch(e&&e.name){case he.BOOLEAN:case he.DATE:case he.STRING:case he.TIME:return t.filter((function(e){return e===de.Equal}));case he.NUMBER:default:return t}}(t.questionRef&&e.props.definedQuestions&&e.props.definedQuestions[t.questionRef]?e.props.definedQuestions[t.questionRef].answerType:void 0).map((function(e,t){return{value:e,label:e}})),l=o.a.createElement(ut.a,{key:"literalo-".concat(n,"-").concat(t.literalId),styles:Mt,options:i,value:i.find((function(e,n){return e.value===t.comparisonOperator})),onChange:e.handleDataChange.bind(e,n,bt.ComparisonOperator)}),s=e.getQuestion(t.questionRef),c=s?s.answerType:void 0,u=s&&s.options?s.options:void 0,d=o.a.createElement(Tt,{options:u,key:"literalv-".concat(n,"-").concat(t.literalId),onChange:e.handleDataChange.bind(e,n,bt.ComparisonValue),defaultValue:t.comparisonValue&&t.comparisonValue.content,type:c}),p=Object.keys(K).map((function(e){return{label:e,value:"AND"===e?K.AND:"OR"===e?K.OR:""}})),m=o.a.createElement(ut.a,{key:"literalfo-".concat(n,"-").concat(t.literalId),styles:Mt,options:p,value:p.find((function(e){return e.value===t.followingOperator})),onChange:e.handleDataChange.bind(e,n,bt.FollowingOperator)});return o.a.createElement("tr",{key:"tr_"+n},o.a.createElement("td",null,o.a.createElement(lt.a,{icon:"arrow-up",onClick:function(){return e.moveLiteralUp(n)}})),o.a.createElement("td",null,"l",o.a.createElement("sub",null,n)),o.a.createElement("td",{className:"questionRef"},r),o.a.createElement("td",{className:"comparisonOperator"},l),o.a.createElement("td",{className:"comparisonValue"},d),o.a.createElement("td",{className:"followingOperator"},m),o.a.createElement("td",null,o.a.createElement(lt.a,{icon:"cross",onClick:function(){e.removeLiteral(n)}})))})),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement(lt.a,{onClick:function(){return e.addLiteral()},icon:"plus"})),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null)))))}}],[{key:"defaultProps",get:function(){return{onChange:function(){}}}}]),t}(o.a.Component),At=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){n.setState({errors:[],literals:e})},n.primaryButtonHandler=function(){var e=(new oe).setLiterals(n.state.literals);oe.checkIfValid(e)?n.props.onSubmit&&n.props.onSubmit(n.state.literals):n.setState({errors:[{message:"Condition is not valid!"}]})},n.secondaryButtonHandler=function(){n.props.onCancel&&n.props.onCancel(n.state.literals)},n.state={isOpen:n.props.isOpen,literals:n.props.condition&&n.props.condition.literals?n.props.condition.literals:[],errors:[]},n.createCondition_=o.a.createRef(),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(lt.e,{isCloseButtonShown:!1,title:"Add/Edit Condition",style:{width:900},isOpen:this.props.isOpen},o.a.createElement("div",{style:{maxHeight:500,overflow:"auto",minHeight:500},className:gt.a.DIALOG_BODY},this.props.isOpen&&o.a.createElement(Ft,{definedQuestions:this.props.definedQuestions,condition:this.props.condition?this.props.condition:void 0,ref:this.createCondition_,onChange:function(t){return e.handleChange(t)}}),o.a.createElement("div",{className:"btn-danger"},this.state.errors.map((function(e){return e.message})))),o.a.createElement("div",{className:gt.a.DIALOG_FOOTER},o.a.createElement("div",{className:gt.a.DIALOG_FOOTER_ACTIONS},o.a.createElement(lt.a,{color:"primary",onClick:this.primaryButtonHandler},"Submit"),o.a.createElement(lt.a,{color:"secondary",onClick:this.secondaryButtonHandler},"Cancel"))))}}]),t}(o.a.Component);At.defaultProps={isOpen:!1,condition:new oe};var xt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={aConditions:n.props.autoAnswer.answeringConditions||[],isEnabled:n.props.autoAnswer.isEnabled},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"editIfTrueFalseValue",value:function(e,t,n){var a=this;this.setState((function(o){var r=void 0,i=ct.a.clone(o.aConditions),l=i[t];return a.props.options&&a.props.answerType.name===he.SELECT?(r=a.props.options.optionsMap[n],"true"===e?l.ifTrue=r.id:"false"===e&&(l.ifFalse=r.id)):("true"===e&&(l.ifTrue=n),"false"===e&&(l.ifFalse=n)),{aConditions:i}}),(function(){a.props.onChange&&a.props.onChange({isEnabled:a.state.isEnabled,answeringConditions:a.state.aConditions})}))}},{key:"openConditionModal",value:function(e){var t=this.state.aConditions[e];ft(o.a.createElement(At,{definedQuestions:this.props.definedQuestions,isOpen:!0,onSubmit:this.editCondition.bind(this,e),onCancel:vt.bind(this),condition:t.condition}))}},{key:"changeEnabled",value:function(){var e=this;this.setState((function(e){return{isEnabled:!e.isEnabled}}),(function(){e.props.onChange&&e.props.onChange({isEnabled:e.state.isEnabled,answeringConditions:e.state.aConditions})}))}},{key:"addAutoFillCondition",value:function(){var e=this;this.setState((function(e){var t=ct.a.clone(e.aConditions),n={condition:new oe,ifTrue:void 0,ifFalse:void 0};return t.push(n),{aConditions:t}}),(function(){e.props.onChange&&e.props.onChange({isEnabled:e.state.isEnabled,answeringConditions:e.state.aConditions})}))}},{key:"editCondition",value:function(e,t){var n=this,a=ct.a.clone(this.state.aConditions);a[e].condition||(a[e].condition=new oe),a[e].condition.setLiterals(t),this.setState({aConditions:a},(function(){vt(),n.props.onChange&&n.props.onChange({isEnabled:n.state.isEnabled,answeringConditions:n.state.aConditions})}))}},{key:"removeAutofillCondition",value:function(e){var t=this;this.setState((function(t){var n=ct.a.clone(t.aConditions);return n.splice(e,1),{aConditions:n}}),(function(){t.props.onChange&&t.props.onChange({isEnabled:t.state.isEnabled,answeringConditions:t.state.aConditions})}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(lt.t,{checked:this.state.isEnabled,onChange:this.changeEnabled.bind(this),label:"Enabled"}),o.a.createElement(lt.l,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null),o.a.createElement("th",null,"Condition"),o.a.createElement("th",null," if True"),o.a.createElement("th",null," if False"),o.a.createElement("th",null))),o.a.createElement("tbody",null,this.state.aConditions.map((function(t,n){var a=function(a){return o.a.createElement(Tt,{key:a,onChange:function(t){return e.editIfTrueFalseValue(a,n,t.value)},options:e.props.options,defaultValue:"true"===a?t.ifTrue:t.ifFalse&&t.ifFalse,type:e.props.answerType})};return o.a.createElement("tr",{key:"af".concat(n)},o.a.createElement("td",null),o.a.createElement("td",null,o.a.createElement(lt.a,{icon:"key",onClick:function(){return e.openConditionModal(n)}})),o.a.createElement("td",null,a("true")),o.a.createElement("td",null,a("false")),o.a.createElement("td",null,o.a.createElement(lt.a,{icon:"cross",onClick:function(){e.removeAutofillCondition(n)}})))})),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement(lt.a,{icon:"plus",onClick:function(){return e.addAutoFillCondition()},type:"button"})),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null)))))}}]),t}(o.a.Component);function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){Object(pt.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dt=document.getElementById("root")||document.body;ht.a.setAppElement(Dt);var Mt={container:function(e,t){return Rt({},e,{border:(t.isFocused,null),background:"transparent",transition:"border-color 0.2s ease, box-shadow 0.2s ease, padding 0.2s ease","&:hover":{boxShadow:"0 2px 4px 0 rgba(41, 56, 78, 0.1)"}})},control:function(e,t){return Rt({},e,{background:"transparent",borderColor:t.isFocused?Gt:e.borderColor,"&:hover":{borderColor:t.isFocused?Gt:e.borderColor}})},valueContainer:function(e,t){return Rt({},e)},menu:function(e,t){return Rt({},e,{borderColor:"#e14eca",position:"absolute",zIndex:"999999999999999999 !important"})},menuList:function(e,t){return Rt({},e)},singleValue:function(e,t){return Rt({},e)},input:function(e,t){return Rt({},e,{color:"white"})},option:function(e,t){return Rt({},e)}},Gt="#46beed",Pt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={question:n.props.question},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleChange",value:function(){this.props.onChange&&this.props.onChange(this.state.question)}},{key:"handleRequiredChange",value:function(e){this.setState((function(e){var t=st.clone(e.question);return t.setIsRequired(!t.isRequired),{question:t}}),this.handleChange.bind(this))}},{key:"openAppearingConditionModal",value:function(){ft(o.a.createElement(At,{definedQuestions:this.props.definedQuestions,isOpen:!0,onSubmit:this.editAppearingCondition.bind(this),onCancel:vt.bind(this),condition:this.state.question.appearingCondition}))}},{key:"editAppearingCondition",value:function(e){var t=this;this.setState((function(t){var n=st.clone(t.question);return n.appearingCondition||n.setAppearingCondition(new oe),n.appearingCondition.setLiterals(e),console.log(oe.toJSON(n.appearingCondition)),{question:n}}),(function(){vt(),t.handleChange()}))}},{key:"handleQuestionChange",value:function(e){this.setState((function(t){var n=st.clone(t.question);return n.setQuestionContent({type:me.String,content:e}),{question:n}}),this.handleChange.bind(this))}},{key:"handleAnswerTypeChange",value:function(e){this.setState((function(t){var n=st.clone(t.question);return n.setAnswerType(e),{question:n}}),this.handleChange.bind(this))}},{key:"handleOptionsChange",value:function(e){this.setState((function(t){var n=st.clone(t.question);return n.setOptions(e),{question:n}}),this.handleChange.bind(this))}},{key:"handleAutoFillChange",value:function(e){this.setState((function(t){var n=st.clone(t.question);return n.setAutoAnswer(e),{question:n}}),this.handleChange.bind(this))}},{key:"handleCustomIdChange",value:function(e){this.setState((function(t){var n=st.clone(t.question);return n.customId=e,{question:n}}),this.handleChange.bind(this))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(lt.c,null,o.a.createElement("h5",{className:"title"},"Add Question"),o.a.createElement(lt.i,null,o.a.createElement(lt.o,{htmlFor:"customid"},"Custom ID"),o.a.createElement(lt.n,{defaultValue:this.state.question.customId,className:"form-control",onChange:function(t){return e.handleCustomIdChange(t.target.value)},id:"custom_id",name:"custom_id",placeholder:"Custom id"})),o.a.createElement(lt.i,null,o.a.createElement(lt.o,{htmlFor:"question"},"Question"),o.a.createElement(lt.u,{fill:!0,defaultValue:this.state.question.questionContent.content,className:"form-control",onChange:function(t){return e.handleQuestionChange(t.target.value)},id:"question",name:"question",placeholder:""})),o.a.createElement(lt.i,null,o.a.createElement(lt.t,{defaultChecked:this.state.question.isRequired,label:"Required",onChange:this.handleRequiredChange.bind(this)})),o.a.createElement(lt.i,null,o.a.createElement(Bt,{answerType:this.state.question.answerType,onChange:this.handleAnswerTypeChange.bind(this)})),this.state.question.answerType&&this.state.question.answerType.name===he.SELECT&&this.state.question.answerType.ofType&&o.a.createElement(lt.i,null,o.a.createElement("label",null,"Add Options"),o.a.createElement(lt.c,null,o.a.createElement(Jt,{constants:this.props.constants,definedQuestions:this.props.definedQuestions,onChange:this.handleOptionsChange.bind(this),defaultOptionType:this.state.question.answerType,options:this.state.question.options}))),o.a.createElement(lt.i,null,o.a.createElement(lt.o,{htmlFor:"type"},"Appearing Condition"),o.a.createElement(lt.a,{type:"button",large:!0,icon:"key",fill:!1,onClick:this.openAppearingConditionModal.bind(this)})),o.a.createElement(lt.i,null,o.a.createElement(lt.i,{label:"Add AutoFill condition"},o.a.createElement(xt,{autoAnswer:this.state.question.autoAnswer,definedQuestions:this.props.definedQuestions,onChange:this.handleAutoFillChange.bind(this),answerType:this.state.question.answerType,options:this.state.question.options})))))}}]),t}(o.a.Component);Pt.defaultProps={question:new be};var Vt,Lt=[{value:he.BOOLEAN,label:"YES/NO"},{value:he.STRING,label:"Text"},{value:he.TIME,label:"Time"},{value:he.DATE,label:"Date"},{value:he.NUMBER,label:"Number"},{value:he.RANGE,label:"Range"},{value:he.SELECT,label:"Multiple Choice"},{value:he.GEOLOCATION,label:"Geo location"}],Qt=Lt.filter((function(e){return e.value&&e.value!==he.SELECT})),Ut=[he.TIME,he.NUMBER,he.DATE,he.TIME],_t=Lt.filter((function(e){return Ut.includes(e.value)})),Bt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={answerType:n.props.answerType},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleAnswerTypeChange",value:function(e){var t=this;this.setState((function(t){var n=ct.a.clone(t.answerType);return n.name=e.value,n.ofType=void 0,{answerType:n}}),(function(){t.props.onChange&&t.props.onChange(t.state.answerType)}))}},{key:"handleSecondSelectChange",value:function(e){var t=this;this.setState((function(t){var n=ct.a.clone(t.answerType);return n.ofType={name:e.value,ofType:void 0},n.ofType.ofType&&(n.ofType.ofType=void 0),{answerType:n}}),(function(){t.props.onChange&&t.props.onChange(t.state.answerType)}))}},{key:"handleThirdSelectChange",value:function(e){var t=this;this.setState((function(t){var n=ct.a.clone(t.answerType);return n.ofType&&(n.ofType.ofType=e.value),{answerType:n}}),(function(){t.props.onChange&&t.props.onChange(t.state.answerType)}))}},{key:"render",value:function(){var e=this,t=this.state.answerType.name===he.SELECT||this.state.answerType.name===he.RANGE,n=this.state.answerType.ofType&&this.state.answerType.ofType.name===he.RANGE,a=this.state.answerType.name===he.SELECT?Qt:this.state.answerType.name===he.RANGE?_t:[],r=this.state.answerType.ofType&&this.state.answerType.ofType.name===he.RANGE?_t:[];return o.a.createElement(o.a.Fragment,null,o.a.createElement(lt.i,{label:"Value Type"},o.a.createElement(ut.a,{onChange:this.handleAnswerTypeChange.bind(this),styles:Mt,options:Lt,value:Lt.find((function(t){return t.value===e.state.answerType.name}))})),t&&o.a.createElement(lt.i,{label:"of Type"},o.a.createElement(ut.a,{onChange:this.handleSecondSelectChange.bind(this),styles:Mt,options:a,value:a.find((function(t){return e.state.answerType.ofType&&t.value===e.state.answerType.ofType.name}))})),n&&o.a.createElement(lt.i,{label:"of Type"},o.a.createElement(ut.a,{onChange:this.handleThirdSelectChange.bind(this),styles:Mt,options:r,value:r.find((function(t){return e.state.answerType.ofType&&e.state.answerType.ofType.ofType&&t.value===e.state.answerType.ofType.ofType.name}))})))}}]),t}(o.a.Component);Bt.defaultProps={answerType:{name:void 0,ofType:void 0}},function(e){e[e.OPTION=1]="OPTION",e[e.GROUP=2]="GROUP"}(Vt||(Vt={}));var Jt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).constantNameInputRef=null,n.makeFromTextInputRef=null,n.state={options:n.props.options||new ce},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"makeConstant",value:function(){var e="const";this.constantNameInputRef&&(e=this.constantNameInputRef.value),this.props.constants.addConstant({id:ye("const-"),name:e,type:{name:he.SELECT,ofType:{name:he.STRING}},value:ce.fromJSON(ce.toJSON(this.state.options))})}},{key:"makeOptionsFromText",value:function(){var e=this;if(this.makeFromTextInputRef){var t=this.makeFromTextInputRef.value.split("\n");this.setState((function(n){var a=ct.a.clone(n.options);return t.forEach((function(t){a.addOption({id:"opt-"+Object.keys(a.optionsMap).length,appearingCondition:void 0,groupName:void 0,type:e.props.defaultOptionType.ofType,value:t})})),{options:a}}))}}},{key:"handleChange",value:function(){this.props.onChange&&this.props.onChange(this.state.options)}},{key:"handleAddNewOption",value:function(){var e=this;this.setState((function(t){var n=ct.a.clone(t.options),a={id:"opt-"+Object.keys(t.options.optionsMap).length,appearingCondition:void 0,groupName:void 0,type:e.props.defaultOptionType.ofType,value:void 0};return n.addOption(a),{options:n}}),this.handleChange.bind(this))}},{key:"handleGroupNameChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.options);return a.changeGroupName(e,t),{options:a}}),this.handleChange.bind(this))}},{key:"handleGroupDelete",value:function(e){this.setState((function(t){var n=ct.a.clone(t.options);return n.deleteGroup(e),{options:n}}),this.handleChange.bind(this))}},{key:"handleOptionTypeChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.options);return a.setOptionTypeFor(e,t),{options:a}}),this.handleChange.bind(this))}},{key:"handleGroupAssignment",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.options);return a.assignOptionToGroup(e,t),{options:a}}),this.handleChange.bind(this))}},{key:"handleGroupUnassignment",value:function(e){this.setState((function(t){var n=ct.a.clone(t.options);return n.unassignGroup(e),{options:n}}),this.handleChange.bind(this))}},{key:"handleOptionDelete",value:function(e){this.setState((function(t){var n=ct.a.clone(t.options);return n.deleteOption(e),{options:n}}),this.handleChange.bind(this))}},{key:"handleOptionValueChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.options);return a.setValueForOption(e,t),{options:a}}),this.handleChange.bind(this))}},{key:"handleAddGroup",value:function(){this.setState((function(e){var t=ct.a.clone(e.options);return t.addGroup(),{options:t}}),this.handleChange.bind(this))}},{key:"handleConditionClick",value:function(e,t){var n;n=e===Vt.GROUP?this.state.options.optionGroupMap[t].appearingCondition:this.state.options.optionsMap[t].appearingCondition,ft(o.a.createElement(At,{definedQuestions:this.props.definedQuestions,isOpen:!0,onSubmit:this.setCondition.bind(this,t,e),onCancel:vt.bind(this),condition:n}))}},{key:"setCondition",value:function(e,t,n){var a=this;this.setState((function(a){var o=ct.a.clone(a.options);if(t===Vt.GROUP){var r=o.optionGroupMap[e];r.appearingCondition||(r.appearingCondition=new oe),r.appearingCondition.setLiterals(n)}else if(t===Vt.OPTION){var i=o.optionsMap[e];i.appearingCondition||(i.appearingCondition=new oe),i.appearingCondition.setLiterals(n)}return{options:o}}),(function(){vt(),a.handleChange()}))}},{key:"handleImportFromConstant",value:function(e){var t=this.props.constants.getConstant(e.value);console.log(e),console.log(t),t&&t.value instanceof ce&&this.setState({options:ce.fromJSON(ce.toJSON(t.value))},this.handleChange.bind(this))}},{key:"render",value:function(){var e=this,t=this.props.constants.ConstantsArray.map((function(e){return{label:e.name,value:e.id}}));return o.a.createElement(lt.b,{fill:!0,vertical:!0},o.a.createElement(lt.j,null,"Import From Constant "),o.a.createElement(ut.a,{styles:Mt,options:t,onChange:this.handleImportFromConstant.bind(this)}),o.a.createElement(lt.f,null),o.a.createElement(lt.j,null,"Export To Constant"),o.a.createElement(lt.n,{placeholder:"Constant name",inputRef:function(t){return e.constantNameInputRef=t}}),o.a.createElement(lt.a,{onClick:this.makeConstant.bind(this)},"Export"),o.a.createElement(lt.f,null),o.a.createElement(lt.j,null,"Make From Text"),o.a.createElement(lt.u,{inputRef:function(t){return e.makeFromTextInputRef=t}}),o.a.createElement(lt.a,{onClick:this.makeOptionsFromText.bind(this)},"Make From Text"),o.a.createElement($t,{defaultType:this.props.defaultOptionType,groups:this.state.options.optionGroupMap?Object.values(this.state.options.optionGroupMap):[],handleGroupAssignment:this.handleGroupAssignment.bind(this),handleOptionTypeChange:this.handleOptionTypeChange.bind(this),handleAddNewOption:this.handleAddNewOption.bind(this),handleOptionDelete:this.handleOptionDelete.bind(this),handleConditionClick:this.handleConditionClick.bind(this,Vt.OPTION),handleOptionValueChange:this.handleOptionValueChange.bind(this),options:this.state.options.optionsMap?Object.values(this.state.options.optionsMap):[]}),o.a.createElement(lt.f,null),o.a.createElement(Ht,{handleAddGroup:this.handleAddGroup.bind(this),handleGroupUnassignment:this.handleGroupUnassignment.bind(this),handleGroupAssignment:this.handleGroupAssignment.bind(this),handleGroupNameChange:this.handleGroupNameChange.bind(this),handleGroupDelete:this.handleGroupDelete.bind(this),handleGroupConditionClick:this.handleConditionClick.bind(this,Vt.GROUP),options:this.state.options.optionsMap?Object.values(this.state.options.optionsMap):[],groups:this.state.options.optionGroupMap?Object.values(this.state.options.optionGroupMap):[]}))}}]),t}(o.a.Component),$t=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={options:n.props.options},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.options.length!==this.props.options.length||e.groups.length!==this.props.groups.length}},{key:"generateAddGroupInput",value:function(e){var t=this,n=this.props.groups.map((function(e){return{value:e.name,label:e.name}})),a=n.find((function(t){return t.value===e.groupName}));return o.a.createElement(dt.a,{value:a||null,styles:Mt,options:n,onChange:function(n){t.props.handleGroupAssignment&&t.props.handleGroupAssignment([e.id],n.value)}})}},{key:"handleAddNewOption",value:function(){this.props.handleAddNewOption&&this.props.handleAddNewOption()}},{key:"handleConditionEdit",value:function(e){this.props.handleConditionClick&&this.props.handleConditionClick(e)}},{key:"handleAddGroupInput",value:function(e){}},{key:"handleOptionDelete",value:function(e){this.props.handleOptionDelete&&this.props.handleOptionDelete(e)}},{key:"handleOptionTypeChange",value:function(e,t){this.props.handleOptionTypeChange&&this.props.handleOptionTypeChange(e,t)}},{key:"handleOptionValueChange",value:function(e,t){this.props.handleOptionValueChange&&this.props.handleOptionValueChange(e,t.value)}},{key:"render",value:function(){var e=this;return o.a.createElement(lt.l,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null),o.a.createElement("th",null,"Id"),o.a.createElement("th",null,"Type"),o.a.createElement("th",null,"Value"),o.a.createElement("th",null,"Condition"),o.a.createElement("th",null,"Group"),o.a.createElement("th",null))),o.a.createElement("tbody",null,this.props.options.map((function(t,n){return o.a.createElement("tr",{key:t.id},o.a.createElement("td",null),o.a.createElement("td",null,t.id),o.a.createElement("td",null,o.a.createElement(Bt,{answerType:t.type,onChange:function(n){return e.handleOptionTypeChange(t.id,n)}})),o.a.createElement("td",null,o.a.createElement(Tt,{onChange:e.handleOptionValueChange.bind(e,t.id),defaultValue:t.value,type:t.type})),o.a.createElement("td",null,o.a.createElement(lt.a,{onClick:e.handleConditionEdit.bind(e,t.id),style:{color:"red",width:20},icon:"key"})),o.a.createElement("td",null,e.generateAddGroupInput(t)),o.a.createElement("td",null,o.a.createElement(lt.a,{style:{width:20},onClick:e.handleOptionDelete.bind(e,t.id),icon:"cross"})))})),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement(lt.a,{style:{width:20},icon:"add",onClick:this.handleAddNewOption.bind(this)})),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null))))}}]),t}(o.a.Component);$t.defaultProps={options:[],groups:[]};var Ht=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleGroupAssignment",value:function(e,t){if(e){var n=e.map((function(e){return e.value}));console.log(n),this.props.handleGroupAssignment&&this.props.handleGroupAssignment(n,t)}}},{key:"render",value:function(){var e=this;return o.a.createElement(lt.l,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null),o.a.createElement("th",null,"Group Name"),o.a.createElement("th",null,"Group Items"),o.a.createElement("th",null,"Appearing Condition"),o.a.createElement("th",null))),o.a.createElement("tbody",null,this.props.groups.map((function(t,n){var a=e.props.options.map((function(e){return{value:e.id,label:e.id}})),r=t.members.map((function(e){return e.id})),i=a.filter((function(e){return r.includes(e.value)}));return o.a.createElement("tr",{key:t.id},o.a.createElement("td",null),o.a.createElement("td",null,o.a.createElement(lt.n,{key:t.id,type:"text",className:"form-control",defaultValue:t.name,onChange:function(n){e.props.handleGroupNameChange&&e.props.handleGroupNameChange(t.name,n.target.value)}})),o.a.createElement("td",null,o.a.createElement(ut.a,{styles:Mt,onChange:function(n,a){if("remove-value"===a.action){var o=a.removedValue.value;e.props.handleGroupUnassignment&&e.props.handleGroupUnassignment([o])}e.handleGroupAssignment(n,t.name)},value:i,isMulti:!0,options:a})),o.a.createElement("td",null,o.a.createElement(lt.a,{style:{width:20},icon:"key",onClick:function(){e.props.handleGroupConditionClick&&e.props.handleGroupConditionClick(t.name)}})),o.a.createElement("td",null,o.a.createElement(lt.a,{style:{width:20},icon:"cross",onClick:function(){e.props.handleGroupDelete&&e.props.handleGroupDelete(t.name)}})))})),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement(lt.a,{style:{width:20},icon:"add",onClick:function(){e.props.handleAddGroup&&e.props.handleAddGroup()}})),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null))))}}]),t}(o.a.Component),Kt=n(148),zt=n(470),Yt=n.n(zt),Zt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement(lt.g,{isOpen:this.props.isOpen})}}]),t}(o.a.Component),Wt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleNodeClick=function(e,t,a){n.props.handleNodeClick&&n.props.handleNodeClick(e,t,a)},n.handleNodeCollapse=function(e,t,a){n.props.handleNodeCollapse&&n.props.handleNodeCollapse(e,t,a)},n.handleNodeExpand=function(e,t,a){n.props.handleNodeExpand&&n.props.handleNodeExpand(e,t,a)},n.state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getNodeFromQuestionOrSection",value:function(e,t,n,a){var o=this,r={id:e.id,icon:void 0,label:"",isSelected:n.includes(e.id),isExpanded:a.includes(e.id)};return e instanceof be?(r.icon="document",r.label="".concat(t," ").concat(e.questionContent.content||"Question")):e instanceof Oe&&(r.icon="folder-close",r.label="".concat(t," ").concat(e.name||"Section"),r.childNodes=e.content.map((function(e,r){return o.getNodeFromQuestionOrSection(e,t+"."+(r+1),n,a)}))),r}},{key:"generateITNodeTree",value:function(e,t,n){var a=this;return[{id:e.id,hasCaret:!0,icon:"folder-close",label:"Root",isExpanded:n.includes(e.id),isSelected:t.includes(e.id),childNodes:e.content.map((function(e,o){return a.getNodeFromQuestionOrSection(e,(o+1).toString(),t,n)}))}]}},{key:"render",value:function(){return console.log(this.props.root_),o.a.createElement(lt.w,{contents:this.generateITNodeTree(this.props.root_,this.props.selectedNodes,this.props.expandedNodes),onNodeClick:this.handleNodeClick,onNodeCollapse:this.handleNodeCollapse,onNodeExpand:this.handleNodeExpand,className:gt.a.ELEVATION_0})}}]),t}(o.a.Component),Xt=n(471),en=n.n(Xt),tn=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isEnabled:n.props.isEnabled,condition:n.props.condition,duplicateTimes:n.props.duplicateTimes},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleQuestionRefChange",value:function(e){this.setState({duplicateTimes:{value:e.value,type:"questionRef"}})}},{key:"handleNumberTimesChange",value:function(e){this.setState({duplicateTimes:{value:e,type:"number"}})}},{key:"handleTypeChange",value:function(e){this.setState((function(t){return{duplicateTimes:{value:"",type:e.value}}}))}},{key:"handleEnabledChange",value:function(){this.setState((function(e){return{isEnabled:!e.isEnabled}}))}},{key:"generateValueComponent",value:function(e){var t=this;if("questionRef"===e){var n=Object.values(this.props.definedQuestions).map((function(e){return{value:e.id,label:e.questionContent.content}})),a="questionRef"===this.state.duplicateTimes.type?n.find((function(e){return e.value===t.state.duplicateTimes.value})):void 0;return o.a.createElement(ut.a,{styles:Mt,options:n,defaultValue:a,onChange:this.handleQuestionRefChange.bind(this)})}return o.a.createElement("input",{defaultValue:"number"===this.state.duplicateTimes.type?this.state.duplicateTimes.value:"",type:"number",className:"form-control",onChange:function(e){return t.handleNumberTimesChange(e.target.value)}})}},{key:"handleSave",value:function(){ct.a.values(this.state).every(ct.a.isEmpty)||this.props.handleSave({isEnabled:this.state.isEnabled,condition:this.state.condition,duplicateTimes:this.state.duplicateTimes})}},{key:"render",value:function(){var e=this,t=[{value:"number",label:"Number"},{value:"questionRef",label:"AnswerValue"}],n=t.find((function(t){return t.value===e.state.duplicateTimes.type}));return o.a.createElement(lt.b,{className:en()(gt.a.ELEVATION_2,gt.a.DARK),vertical:!0,fill:!0},o.a.createElement(lt.t,{onChange:this.handleEnabledChange.bind(this),defaultChecked:this.props.isEnabled},"Enabled"),o.a.createElement(lt.f,null),o.a.createElement(ut.a,{menuContainerStyle:{zIndex:99999},styles:Mt,onChange:function(t){return e.handleTypeChange(t)},options:t,defaultValue:n}),this.generateValueComponent(this.state.duplicateTimes.type),o.a.createElement(lt.f,null),o.a.createElement(lt.b,{fill:!0},o.a.createElement(lt.a,{onClick:this.handleSave.bind(this)},"Save"),o.a.createElement(lt.a,{onClick:this.props.handleCancel},"Cancel")))}}]),t}(o.a.Component),nn=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),r=n[0],i=n[1];return o.a.createElement(lt.b,{style:{paddingBottom:"20px"},fill:!0,vertical:!0},o.a.createElement(lt.b,null,o.a.createElement(lt.a,{onClick:function(){return e.handleMoveUp(e.questionId,e.path)},style:{height:50,width:20},icon:"arrow-up"}),o.a.createElement(lt.a,{style:{height:50},onClick:function(){return i(!r)},alignText:"left",rightIcon:r?"chevron-up":"chevron-down"},"Q ",o.a.createElement("span",null,e.readablePath," ")," ",o.a.createElement("span",null," ",e.questionTitle," ")),o.a.createElement(lt.a,{onClick:function(){return e.handleDeletion(e.questionId,e.path)},style:{height:50,width:20},alignText:"left",rightIcon:"cross"})),o.a.createElement(lt.d,{keepChildrenMounted:!1,isOpen:r},e.children))},an=n(211),on=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),r=n[0],i=n[1];return o.a.createElement(lt.b,{style:{paddingBottom:"20px"},fill:!0,vertical:!0},o.a.createElement(lt.b,null,o.a.createElement(lt.a,{style:{width:20},icon:"arrow-up",onClick:function(){return e.handleMoveUp(e.sectionId,e.path)}}),o.a.createElement(lt.r,null,o.a.createElement(lt.r.Group,{align:an.a.LEFT},o.a.createElement(lt.j,null,o.a.createElement("span",null,e.readablePath," "),o.a.createElement(lt.h,{onChange:e.handleSectionNameChange,placeholder:"Section",defaultValue:e.sectionName}," "))),o.a.createElement(lt.r.Group,{align:an.a.RIGHT},o.a.createElement(lt.h,{onChange:e.handleCustomIdChange,placeholder:"Custom Id",defaultValue:e.customId}," "),o.a.createElement(lt.a,{icon:"key",onClick:function(){return e.handleOpenConditionSettings()}}),o.a.createElement(lt.a,{onClick:function(){return i(!r)},icon:"cog"}),o.a.createElement(lt.a,{icon:"folder-open",onClick:function(){return e.onClick(e.sectionId,e.path)}}))),o.a.createElement(lt.a,{style:{width:20},icon:"cross",onClick:function(){return e.handleDeletion(e.sectionId,e.path)}})),o.a.createElement(lt.d,{isOpen:r,keepChildrenMounted:!1},e.children))},rn=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleQuestionChange",value:function(e,t){this.props.handleQuestionChange&&this.props.handleQuestionChange(e,t)}},{key:"handleDuplicatingSettingsSave",value:function(e,t){this.props.handleSectionDuplicatingSettingsChange&&this.props.handleSectionDuplicatingSettingsChange(e,t)}},{key:"handleDuplicatingSettingsCancel",value:function(){}},{key:"openConditionSettings",value:function(e){var t=this,n=e.appearingCondition;ft(o.a.createElement(At,{definedQuestions:this.props.definedQuestions,isOpen:!0,onSubmit:function(n){t.props.handleSectionConditionChange(e.id,n),vt()},onCancel:vt.bind(this),condition:n}))}},{key:"render",value:function(){var e,t=this,n=ge(this.props.parentPath);return n&&(n+="."),e=this.props.section.content.map((function(e,a){var r=t.props.parentPath.concat(a);return e instanceof be?o.a.createElement(nn,{questionTitle:e.questionContent.content,handleMoveUp:t.props.handleMoveUp,path:r,questionId:e.id,handleDeletion:t.props.handleDeleteChildSectionOrQuestion,readablePath:n+(a+1),key:e.id,isExpanded:!1},o.a.createElement(Pt,{constants:t.props.constants,definedQuestions:t.props.definedQuestions,onChange:function(e){return t.handleQuestionChange(e,r)},question:e})):e instanceof Oe?o.a.createElement(on,{customId:e.customId,handleCustomIdChange:function(n){return t.props.handleSectionCustomIdChange(e.id,n)},handleMoveUp:t.props.handleMoveUp,sectionName:e.name,handleSectionNameChange:function(n){return t.props.handleSectionNameChange(e.id,n)},path:r,handleDeletion:t.props.handleDeleteChildSectionOrQuestion,sectionId:e.id,readablePath:n+(a+1),handleOpenConditionSettings:function(){return t.openConditionSettings(e)},key:e.id,onClick:t.props.handleSectionClick},o.a.createElement(tn,Object.assign({definedQuestions:t.props.definedQuestions,handleSave:function(n){return t.handleDuplicatingSettingsSave(e.id,n)},handleCancel:t.handleDuplicatingSettingsCancel},e.duplicatingSettings))):null})),o.a.createElement(lt.b,{fill:!0,vertical:!0},e)}}]),t}(o.a.Component),ln=[{type:"button",name:"up-one-level",icon:"arrow-up",text:""},{type:"button",name:"save-root",icon:"floppy-disk",text:"Save Form"},{type:"button",name:"add-section",icon:"box",text:"Add Section"},{type:"button",name:"add-question",icon:"document",text:"Add Question"},{type:"button",name:"copy-state",icon:"clipboard",text:"Copy State"}],sn=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){this.props.handleItemClick&&this.props.handleItemClick(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(lt.r,{fixedToTop:!0},o.a.createElement(lt.r.Group,{align:an.a.LEFT},this.props.children,ln.map((function(t){return o.a.createElement(lt.a,{onClick:e.handleClick.bind(e,t.name),key:t.name,icon:t.icon,text:t.text,className:"bp3-minimal"})}))))}}]),t}(o.a.Component),cn=(n(793),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={selectedNodes:[],expandedNodes:[n.props.root.id],root:n.props.root||new Ne,activeSection:n.props.root,activeSectionPath:[0],constants:new fe},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"getAllEntries",value:function(e,t,n,a){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5?arguments[5]:void 0;if(r||(r=[]),!(e.length<=0)){var i=Ne.getFromPath(e,[n]);if(i){for(var l=t;l<i.content.length;l++){var s=i.content[l];s instanceof be?a!==Ce.QUESTION&&a||r.push(s):s instanceof Oe&&(a!==Ce.SECTION&&a||r.push(s),this.getAllEntries(e.concat(l),0,n,a,!1,r))}if(o){var c=e.slice(0),u=c.pop();"number"===typeof u&&this.getAllEntries(c,u,n,a,!0,r)}return r}}}},{key:"handleAddSection",value:function(){var e=this;this.setState((function(t){var n=ct.a.clone(t.root);return n.addSection(e.state.activeSectionPath),{root:n}}),(function(){e.props.onChange&&e.props.onChange(e.state.root)}))}},{key:"handleAddQuestion",value:function(){var e=this;this.setState((function(t){var n=ct.a.clone(t.root);return n.addQuestion(e.state.activeSectionPath),{root:n}}),(function(){e.props.onChange&&e.props.onChange(e.state.root)}))}},{key:"handleDeleteQuestionOrSection",value:function(e,t){var n=this;this.setState((function(a){var o=a.activeSection,r=a.activeSectionPath,i=t.slice(0,t.length-1),l=ct.a.clone(a.root),s=Ne.getFromPath(t,[n.state.root]);if(s&&e!==s.id)throw new Error("cannot delete, id mismatch");if(s instanceof be)l.removeQuestion(s.id,t);else if(s instanceof Oe&&(l.removeSection(s.id,t),s.id===a.activeSection.id)){var c=Ne.getFromPath(i,[n.state.root]);!c||c instanceof be||(o=c,r=i)}return{root:l,activeSection:o,activeSectionPath:r}}),(function(){n.props.onChange&&n.props.onChange(n.state.root)}))}},{key:"handleUpOneLevel",value:function(){if(this.state.activeSectionPath.length>1){var e=this.state.activeSectionPath.slice(0,this.state.activeSectionPath.length-1),t=Ne.getFromPath(e,[this.state.root]);!t||t instanceof be||this.setState((function(n){return{activeSection:t?t instanceof be?n.activeSection:t:n.activeSection,activeSectionPath:e}}))}}},{key:"handleSave",value:function(){this.props.onSave&&this.props.onSave(this.state.root)}},{key:"handleToolbarItemClick",value:function(e){switch(e){case"add-section":this.handleAddSection();break;case"add-question":this.handleAddQuestion();break;case"up-one-level":this.handleUpOneLevel();break;case"save-root":this.handleSave();break;case"copy-state":var t=JSON.stringify(Ne.toJSON(this.state.root));Yt()(t);var n={message:"Copied state to clipboard",icon:"tick",intent:Kt.a.SUCCESS};this.toasterRef.show(n)}}},{key:"handleQuestionUpdate",value:function(e,t){var n=this;this.setState((function(a){var o=ct.a.clone(a.root),r=t.slice(0,t.length-1);Ne.getFromPath(r,[o])instanceof be||n.state.root.questions[e.id].updateFromQuestion(e);return{root:o}}),(function(){n.props.onChange&&n.props.onChange(n.state.root)}))}},{key:"handleFormTreeNodeExpand",value:function(e,t,n){e.isExpanded=!0;var a=Ne.getFromPath(t,[this.state.root]);a&&this.setState((function(e){return{expandedNodes:a?ct.a.union([a.id],e.expandedNodes):e.expandedNodes}}))}},{key:"handleFormTreeNodeCollapse",value:function(e){this.setState((function(t){return{expandedNodes:t.expandedNodes.filter((function(t){return e.id!==t}))}}))}},{key:"handleFormTreeNodeClick",value:function(e,t,n){var a=Ne.getFromPath(t,[this.state.root]);!a||a instanceof be?a&&this.setState((function(e){var n=t.length>1?t.slice(0,t.length-1):t,a=Ne.getFromPath(n,[e.root]),o=Ne.getFromPath(t,[e.root]),r=e.expandedNodes,i=o?[o.id]:e.selectedNodes;return!a||a instanceof be||(r=ct.a.union([a.id],r),i.push(a.id)),{expandedNodes:r,selectedNodes:i,activeSection:!a||a instanceof be?e.activeSection:a,activeSectionPath:n}})):this.setState((function(e){var n=a?ct.a.union([a.id],e.expandedNodes):e.expandedNodes;return{selectedNodes:a?[a.id]:e.selectedNodes,expandedNodes:n,activeSection:!a||a instanceof be?e.activeSection:a,activeSectionPath:t}}))}},{key:"handleRootNameChange",value:function(e){var t=this;this.setState((function(t){var n=ct.a.clone(t.root);return n.name=e,{root:n}}),(function(){t.props.onChange&&t.props.onChange(t.state.root)}))}},{key:"handleSectionChange",value:function(e,t){this.setState((function(e){var n=Ne.getFromPath(t,[e.root]),a=e.expandedNodes,o=[];return n&&n instanceof Oe&&(a=ct.a.union([n.id],a),o.push(n.id)),{expandedNodes:a,selectedNodes:o,activeSection:!n||n instanceof be?e.activeSection:n,activeSectionPath:t}}))}},{key:"handleDuplicatingSettingsChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.root);return a.sections[e].setDuplicatingSettings(t),{root:a}}))}},{key:"handleSectionNameChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.root);return a.sections[e].name=t,{root:a}}))}},{key:"handleMoveUp",value:function(e,t){this.setState((function(e){var n=ct.a.clone(e.root),a=ct.a.clone(t);return a[a.length-1]>0&&(a[a.length-1]=a[a.length-1]-1),n.moveItem(t,a),{root:n}}))}},{key:"handleSectionConditionChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.root);return a.sections[e].appearingCondition.setLiterals(t),{root:a}}))}},{key:"handleSectionCustomIdChange",value:function(e,t){this.setState((function(n){var a=ct.a.clone(n.root);return a.sections[e].customId=t,{root:a}}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(lt.v,{ref:function(t){return t?e.toasterRef=t:null}}),o.a.createElement(Zt,{isOpen:!1}),o.a.createElement(sn,{handleItemClick:this.handleToolbarItemClick.bind(this)},o.a.createElement(lt.h,{value:this.state.root.name,onChange:this.handleRootNameChange.bind(this)})),o.a.createElement("div",{style:{display:"flex",flexDirection:"row",padding:16},className:"builder-container"},o.a.createElement("div",{style:{background:"transparent",marginRight:20},className:"builder-sidebar"},o.a.createElement("div",{className:"tree-sidebar-wrapper"},o.a.createElement(Wt,{expandedNodes:this.state.expandedNodes,selectedNodes:this.state.selectedNodes,handleNodeExpand:this.handleFormTreeNodeExpand.bind(this),handleNodeCollapse:this.handleFormTreeNodeCollapse.bind(this),handleNodeClick:this.handleFormTreeNodeClick.bind(this),root_:this.state.root}))),o.a.createElement("div",{style:{width:"100%"},className:""},o.a.createElement(rn,{handleSectionCustomIdChange:this.handleSectionCustomIdChange.bind(this),handleSectionConditionChange:this.handleSectionConditionChange.bind(this),handleMoveUp:this.handleMoveUp.bind(this),constants:this.state.constants,handleSectionNameChange:this.handleSectionNameChange.bind(this),definedQuestions:this.state.root.questions,handleSectionDuplicatingSettingsChange:this.handleDuplicatingSettingsChange.bind(this),handleSectionClick:this.handleSectionChange.bind(this),handleDeleteChildSectionOrQuestion:this.handleDeleteQuestionOrSection.bind(this),parentPath:this.state.activeSectionPath,handleQuestionChange:this.handleQuestionUpdate.bind(this),section:this.state.activeSection}))))}}]),t}(o.a.Component)),un=(o.a.Component,n(198)),dn=n(197);function pn(){var e=Object(xe.a)(["\n    mutation SaveForm($saveFile: FormFileInput!){\n        saveForm(form: $saveFile){\n          id\n        }\n      }"]);return pn=function(){return e},e}function mn(){var e=Object(xe.a)(["\n    query GetForm($formId:[String!]){\n        forms(id: $formId){\n          id\n          name\n          content\n        }\n      } \n"]);return mn=function(){return e},e}var hn=Qe()(mn()),fn=Qe()(pn());var vn=n(481),gn=n(914);function yn(e){switch(e.question.type.name){case he.NUMBER:return o.a.createElement(Ge.a,{key:"form-input"+e.fieldProps.input.name,value:e.fieldProps.input.value,onChange:e.fieldProps.input.onChange,type:"number"});case he.STRING:return o.a.createElement(Ge.a,{key:"form-input"+e.fieldProps.input.name,value:e.fieldProps.input.value,onChange:e.fieldProps.input.onChange,type:"text"});case he.GEOLOCATION:return o.a.createElement(Ge.a,{key:"form-input"+e.fieldProps.input.name,value:e.fieldProps.input.value,onChange:e.fieldProps.input.onChange,type:"number"});case he.DATE:return o.a.createElement(gn.a,Object.assign({key:"form-input"+e.fieldProps.input.name},e.fieldProps.input));case he.SELECT:return o.a.createElement(En,{value:e.fieldProps.input.value,key:"form-input"+e.fieldProps.input.name,options:e.question.options,onChange:e.fieldProps.input.onChange})}}var bn={display:"block",height:"30px",lineHeight:"30px"};function En(e){return o.a.createElement(De.a.Group,{value:e.value,onChange:e.onChange},e.options.map((function(e){return o.a.createElement(De.a,{style:bn,key:e.id,value:e.id},e.text)})))}var Cn=n(107),On=n(444),Sn=n(254),kn=n(167);function Nn(e){return o.a.createElement(kn.a,{placement:"top",title:e.title},o.a.createElement(Pe.a,{onClick:e.onClick,className:"float ".concat(e.className),type:e.type,shape:e.shape,icon:e.icon}))}var wn=n(356),In=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"checkIfQuestionHasCondition",value:function(e){if(e.appearingCondition.literals.length>0)return!0;var t=e.options&&e.options.SortedOptions,n=t.groups,a=t.rootOptions;return!!n.find((function(e){return e.appearingCondition.literals.length>0}))||!!a.find((function(e){return e.appearingCondition.literals.length>0}))}},{key:"makeTree",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n[t.id]=Object(B.a)({},t,{childNodes:[],_type:t instanceof Oe?"section":"root"}),n[t.id].childNodes=[];for(var a=0;a<n[t.id].content.length;a++){var o=n[t.id].content[a];o.hasOwnProperty("content")?(e.makeTree(o,n),n[t.id].childNodes.push(o.id)):(n[o.id]=Object(B.a)({},o,{_type:"question"}),n[t.id].childNodes.push(o.id))}return delete n[t.id].content,n}},{key:"transformValueToType",value:function(e,t){switch(e.name){case he.BOOLEAN:return Boolean(t);case he.DATE:return new Date(t);case he.NUMBER:return parseFloat(t);case he.STRING:return t;case he.TIME:return new Date(t)}return t}},{key:"evaluateCondition",value:function(t,n,a){var o=!0,r=null;return t?(t.literals&&t.literals.forEach((function(t){var i=e.isLiteralValid(t,n,a);if(r){if(r)switch(r){case K.AND:o=o&&i;break;case K.OR:o=o||i}}else o=i,r=t.followingOperator})),o):o}},{key:"findValue",value:function(t,n){if(t)for(var a=Object.keys(t),o=0;o<a.length;o++){var r=a[o],i=t[r];if(Array.isArray(i)){var l=e.findValue(i[i.length-1],n);if(l)return l}else if(r===n)return i}}},{key:"getProgress",value:function(e){var t=0,n=0;return Object.keys(e).forEach((function(a){var o=e[a];t+=o.filled,n+=o.required})),t/n}},{key:"getDupeTimes",value:function(t,n){if(!t)return-1;if(t.isEnabled){var a=t.duplicateTimes;if("number"===a.type)return parseInt(a.value);var o=a.value,r=e.findValue(n,o);return r?parseInt(r):0}return-1}},{key:"collectDependencies",value:function(e){var t=[],n=[],a=[],o=[],r=null;if(e instanceof be||"question"===e._type){t=e&&e.appearingCondition&&e.appearingCondition.literals?e.appearingCondition.literals.map((function(e){return e.questionRef})):void 0,e.autoAnswer.answeringConditions.forEach((function(e){return e.condition.literals.forEach((function(e){return o.push(e.questionRef)}))}));var i=Object.values(e.options.optionsMap).filter((function(e){return!e.groupName}));Object.values(e.options.optionGroupMap).forEach((function(e){return e.appearingCondition&&e.appearingCondition.literals.forEach((function(e){return n.push(e.questionRef)}))})),i.forEach((function(e){return e.appearingCondition&&e.appearingCondition.literals.forEach((function(e){return a.push(e.questionRef)}))}))}else if(e instanceof Oe||"section"===e._type){t=e&&e.appearingCondition&&e.appearingCondition.literals?e.appearingCondition.literals.map((function(e){return e.questionRef})):void 0,r=e.duplicatingSettings.isEnabled&&"questionRef"===e.duplicatingSettings.duplicateTimes.type?e.duplicatingSettings.duplicateTimes.value:null}var l=new Set([].concat(t,n,a,r?[r]:[]));return{all:Array.from(l),autoFillConditions:Array.from(new Set(t)),groupConditions:Array.from(new Set(n)),rootOptionConditions:Array.from(new Set(a)),duplicationRef:r}}}]),e}();In.isLiteralValid=function(e,t,n){var a=!0,o=t[e.questionRef],r=n[e.questionRef];if(!r)throw new Error("No question was provided");var i=In.transformValueToType(r.answerType,e.comparisonValue.content),l=In.transformValueToType(r.answerType,o);switch(e.comparisonOperator){case de.Equal:a=l===i;break;case de.Greater_Than:a=l>i;break;case de.Greater_Than_Or_Equal:a=l>=i;break;case de.Less_Than:a=l<i;break;case de.Less_Than_Or_Equal:a=l>=i}return a};var Tn=n(443);var jn=n(151),Fn=n.n(jn),An=n(446),xn=n(46),qn=function(e,t){return e.rootForms},Rn=function(e,t){return t.rootId},Dn=function(e,t){return e.filledForms},Mn=function(e,t){return e},Gn=function(e,t){return t.valueLocationName||t.locationName},Pn=Object(xn.createSelector)([Dn,function(e,t,n){return t.formId||n}],(function(e,t){return e.byId[t]})),Vn=n(352),Ln=n.n(Vn),Qn=function(e){return e?void 0:"Required field."},Un=Object(xn.createSelector)([qn,Rn],(function(e,t){return e.byId[t]})),_n=(Object(xn.createSelector)([Un],(function(e){return e.questions})),Object(xn.createSelector)([Un],(function(e){return e.sections}))),Bn=Object(xn.createSelector)([_n,function(e,t){return t.sectionId}],(function(e,t){return e[t]})),Jn=(Object(xn.createSelector)([Bn],(function(e){return e.duplicatingSetings})),Ln()([Rn,Dn],(function(e,t){var n=[];return Object.values(t.byId).forEach((function(t){t.formId===e&&n.push(t.id)})),n}))((function(e,t){return t.rootId}))),$n=Object(xn.createSelector)([function(e,t){return t.formId},Mn],(function(e,t){return Object(An.a)(e)(t)})),Hn=Object(xn.createSelector)([Un,function(e,t){return t.questionId||t.id}],(function(e,t){return e[t]})),Kn=Object(xn.createSelector)([Hn],(function(e){return e.options})),zn=Object(xn.createSelector)([Kn],(function(e){return{rootOptions:Object.values(e.optionsMap).filter((function(e){return!e.groupName})),groups:Object.values(e.optionGroupMap)}})),Yn=Object(xn.createSelector)([zn],(function(e){var t=e.groups,n=e.rootOptions,a=[];return t.forEach((function(e){a=a.concat(e.appearingCondition?e.appearingCondition.literals.map((function(e){return e.questionRef})):[])})),n.forEach((function(e){a=a.concat(e.appearingCondition?e.appearingCondition.literals.map((function(e){return e.questionRef})):[])})),Array.from(new Set(a))})),Zn=Object(xn.createSelector)([Gn,Yn,$n],(function(e,t,n){var a={};if(!n)return a;var o=Fn.a.toPath(e);return t.forEach((function(e){var t=function e(t,n,a){if(0!==n.length){var o=n.slice(0);o.splice(n.length-1,1,a);var r=Fn.a.get(t,o);return r||(o.splice(o.length-1,1),e(t,o,a))}}(n,o,e);t&&(a[e]=t)})),a})),Wn=(Object(xn.createSelector)([Hn],(function(e){return e.questionContent.content})),Object(xn.createSelector)([Hn],(function(e){return e.answerType})),Object(xn.createSelector)([zn,Zn,Un],(function(e,t,n){var a=e.groups,o=e.rootOptions;return{groups:a.filter((function(e){return In.evaluateCondition(e.appearingCondition,t,n)})),rootOptions:o.filter((function(e){return In.evaluateCondition(e.appearingCondition,t,n)}))}}))),Xn=Object(xn.createSelector)(Wn,(function(e){var t=e.groups,n=e.rootOptions,a=[];return t.forEach((function(e){return e.members.forEach((function(e){a.push({id:e.id,text:e.value})}))})),n.forEach((function(e){a.push({id:e.id,text:e.value})})),a})),ea=Ln()([Gn,Mn,Jn],(function(e,t,n){var a=[];n.forEach((function(e){a.push(Object(An.a)(e)(t))}));var o=Fn.a.toPath(e),r={};return a.forEach((function(e){var t=Fn.a.get(e,o);t&&(t=t.trim(),r[t]?r[t].strength++:r[t]={text:t,strength:1})})),Object.values(r).sort((function(e,t){return t.strength-e.strength}))}))((function(e,t){return t.locationName})),ta=(Object(xn.createSelector)(Hn,(function(e){var t=[];return e.isRequired&&t.push(Qn),t})),Object(xn.createSelector)([Pn,qn],(function(e,t){var n=e.formId;return t.byId[n]}))),na=Object(xn.createSelector)([ta,function(e,t,n){return n||t.id||t.sectionId||t.questionId}],(function(e,t){return e[t]})),aa=Object(xn.createSelector)([na],(function(e){return e._type})),oa=(Object(xn.createSelector)([na],(function(e){return e.name})),Object(xn.createSelector)([na],(function(e){return e.childNodes}))),ra=Object(xn.createSelector)([Pn,ta],(function(e,t){return t[e.formId]})),ia=(Object(xn.createSelector)([ra],(function(e){return e.childNodes})),Object(xn.createSelector)([na],(function(e){return e.duplicatingSettings}))),la=Object(xn.createSelector)([ia,Gn,$n],(function(e,t,n){if(e&&e.isEnabled){var a=e.duplicateTimes;if("number"===a.type)return parseInt(a.value);var o=function e(t,n){if(!t)return;for(var a=Object.keys(t),o=0;o<a.length;o++){var r=a[o],i=t[r];if(Array.isArray(i)){var l=e(i[i.length-1],n);if(l)return l}else if(r===n)return i}return}(n,a.value);return o?parseInt(o):0}return-1})),sa=Object(xn.createSelector)([ta,$n,Rn],(function(e,t,n){var a={};return function e(t,n,a,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=!t.appearingCondition||In.evaluateCondition(t.appearingCondition,n,a);r[t.id]||(r[t.id]={filled:0,required:0,unfilled:[],dupe:-1});if(l){var s=In.getDupeTimes(t.duplicatingSettings,n),c=-1===s?1:s;r[t.id].dupe=s;for(var u=function(l){t.childNodes.forEach((function(s,c){var u=i?[s]:Fn.a.toPath(o).concat(l.toString(),s);"question"===a[s]._type?!a[s].isRequired||(!!Fn.a.get(n,u)?r[t.id].filled++:r[t.id].unfilled.push(u),r[t.id].required++):e(a[s],n,a,u,r)}))},d=0;d<c;d++)u(d)}}(e[n],t,e,"",a,!0),a}));Object(xn.createSelector)([Dn,Mn,qn],(function(e,t,n){return Object.keys(e.byId).map((function(a){var o=e.byId[a].formId,r=Object(An.a)(a)(t),i=n.byId[o].name;return{formId:a,rootId:o,startedDate:e.byId[a].startedDate,count:sa(t,{formId:a,rootId:o}),submitted:e.byId[a].submitted,values:r,formName:i||"Main Form"}}))}));var ca=Object(xn.createSelector)([Mn,function(e,t){return t}],(function(e,t){return function(n){return aa(e,t,n)}})),ua=Object(f.b)((function(e,t){var n=na(e,t),a=n.answerType,o=n.questionContent.content,r=In.collectDependencies(n);return{isRequired:n.isRequired,autoCompleteData:ea(e,t),isDependent:r.all.length>0,dependencies:r,title:o,type:a,options:a.name===he.SELECT?Xn(e,t):[]}}),null)((function(e){var t=Object(a.useContext)(Oa),n=e.isRequired,r=e.autoCompleteData,i=e.options,l=e.type,s=e.dependencies,c=e.title,u=e.path;return o.a.createElement(Tn.a,{key:"field"+e.locationName,name:e.locationName,props:{isRequired:n,autoCompleteData:r,options:i,type:l,dependencies:s,title:c,path:u},component:t.renderQuestion})})),da=function(e,t){return t.map((function(t,n){return function(e){var t=e.formId,n=e.rootId,a=e.typeChecker,r=e.path,i=e.locationName,l=e.id,s=e.index,c=e.iteration,u=e.hideIterationInPath,d=e.isInRootNode,p=u?r.concat(s):r.concat(c,s),m=d?l:i.concat("[".concat(c,"].").concat(l));return"section"===a(l)?o.a.createElement(ha,{formId:t,rootId:n,key:m,id:l,path:p,locationName:m}):o.a.createElement(ua,{key:m,formId:t,rootId:n,id:l,path:p,locationName:m})}(Object(B.a)({},e,{index:n,id:t}))}))},pa=function(e,t,n){return o.a.createElement(wn.a,{defaultActiveKey:"0",tabPosition:"top"},Object(Ze.a)(Array(n).keys()).map((function(n){return o.a.createElement(wn.a.TabPane,{tab:"Record-".concat(n),key:n.toString()},o.a.createElement("div",{style:{maxHeight:580,overflow:"auto"}},da(Object(B.a)({},e,{iteration:n}),t)))})))};function ma(){return o.a.createElement(un.a,{image:un.a.PRESENTED_IMAGE_SIMPLE,description:"Not Required to Fill"})}var ha=Object(f.b)((function(e,t){var n=la(e,t),a=na(e,t,t.id);return{childNodes:oa(e,t),name:a.name,duplicateTimes:n,typeChecker:ca(e,t)}}),null)((function(e){var t=Object(a.useContext)(Oa);return o.a.createElement(Ie.a,{style:{marginTop:16}},t.renderSectionHeader(e.name,e.path,e.rootId===e.id?"root":"section"),function(t){var n={formId:e.formId,rootId:e.rootId,typeChecker:e.typeChecker,path:e.path,locationName:e.locationName,iteration:0,hideIterationInPath:!0,isInRootNode:e.rootId===e.id,index:void 0,id:void 0};return-1!==t?0===t?o.a.createElement(ma,{key:"nr"+e.locationName}):pa(Object(B.a)({},n,{hideIterationInPath:!1}),e.childNodes,t):da(n,e.childNodes)}(e.duplicateTimes))}));function fa(){var e=Object(xe.a)(["\nquery GetForm($id: [String]!){\n    forms(id:$id){\n      id\n      content\n      name\n      \n  \n    }\n  }\n  "]);return fa=function(){return e},e}function va(){var e=Object(xe.a)(["\nquery getFilled($ids: [String]!){\n    getFilledFormById(ids:$ids){\n      id\n      formId\n      answerStore\n      completedDate\n      startedDate\n      filledBy{\n          firstName\n          lastName\n          email\n      }\n    }\n  }"]);return va=function(){return e},e}function ga(){var e=Object(xe.a)(["\nmutation SaveForm($filledForm: FilledFormInput!){\n    saveFilledForm(filledForm: $filledForm){\n        completedDate\n    }\n}"]);return ga=function(){return e},e}var ya=Qe()(ga()),ba=Qe()(va()),Ea=Qe()(fa());var Ca=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).client=void 0,n.state={isSaveConfirmVisible:!1},n.toggleSaveConfirmVisibility=function(){n.setState({isSaveConfirmVisible:!n.state.isSaveConfirmVisible})},n.saveForm=function(){n.props.handleSubmit((function(e){var t=Object(L.a)(n.props.filledForm,(function(t){delete t.filledBy,t.answerStore=JSON.stringify(e)}));n.client.mutate({mutation:ya,variables:{filledForm:t}}).then((function(e){Re.a.success("Form has been submitted."),n.toggleSaveConfirmVisibility()})).catch((function(e){throw Re.a.error("Something went wrong, try again later!"),new Sn.a({_error:"Could not save the form!"})}))}))()},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=new URLSearchParams(this.props.location.search),n=t.get("rootId"),a=t.get("formId");Promise.all([this.client.query({query:ba,variables:{ids:[a]}}),this.client.query({query:Ea,variables:{id:[n]}})]).then((function(t){var o=t[0].data,r=t[1].data;if(o.getFilledFormById[0]&&r.forms){var i=r.forms[0];"string"===typeof i.content&&(i.content=JSON.parse(i.content));var l=function e(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t instanceof Oe?"section":"root",o=Object(B.a)({},t,{_type:a,childNodes:[]}),r=0;r<t.content.length;r++){var i=t.content[r];if(i instanceof Oe)o.childNodes.push(i.id),e(i,n);else{o.childNodes.push(i.id);var l=Object(B.a)({},i,{_type:"question"});n[i.id]=l}}return n[t.id]=o,n}(Ne.fromJSON(i));e.handleRootFormAdd(n,l);var s=o.getFilledFormById[0];"string"===typeof s.answerStore&&(s.answerStore=JSON.parse(s.answerStore)),e.initializeForm(a,s.answerStore);var c={formId:s.formId,id:s.id,completedDate:s.completedDate,filledBy:s.filledBy,startedDate:s.startedDate};e.handleFilledFormAdd(a,c)}}))}},{key:"render",value:function(){var e=this,t=new URLSearchParams(this.props.location.search),n=t.get("rootId"),a=t.get("formId"),r=this.props,i="";if(r.rootForm&&r.rootForm[n]){var l=r.rootForm[n];"root"===l._type&&(i=l.name)}return o.a.createElement(qe.a,null,(function(t){return e.client=t,o.a.createElement(Oa.Provider,{value:{renderQuestion:r.renderQuestion,renderSectionHeader:r.renderSectionHeader}},r.filledForm&&r.rootForm&&r.renderRootSectionHeader&&r.renderRootSectionHeader(r.filledForm,i),o.a.createElement(Xe.a,{spinning:!r.filledForm||!r.rootForm},r.filledForm&&r.rootForm&&o.a.createElement(ha,{rootId:n,id:n,formId:a,path:[0],locationName:""})),o.a.createElement(tt.a,{title:"Are you sure you want to make the changes?",visible:e.state.isSaveConfirmVisible,onConfirm:e.saveForm,onCancel:e.toggleSaveConfirmVisibility,placement:"left"},o.a.createElement(Nn,{onClick:e.toggleSaveConfirmVisibility,title:"Save Form",type:"primary",shape:"circle",icon:"save"})))}))}}]),t}(o.a.Component),Oa=o.a.createContext({renderSectionHeader:function(e,t){return null},renderQuestion:function(){return null}}),Sa=Object(On.a)({destroyOnUnmount:!1})(Ca),ka=Object(f.b)((function(e,t){var n=new URLSearchParams(t.location.search),a=n.get("formId"),o=n.get("rootId");return{form:a,filledForm:e.filledForms.byId[a],rootForm:e.rootForms.byId[o]}}),(function(e){return{handleRootFormAdd:function(t,n){return e({type:S,payload:{id:t,root:n}})},handleFilledFormAdd:function(t,n){return e(function(e,t){return{type:O,payload:{id:e,filledForm:t}}}(t,n))},initializeForm:function(t,n){return e(Object(Cn.b)(t,n))}}}))(Sa),Na=Object(g.i)(ka),wa=n(120),Ia=n(479),Ta=n(355),ja=n.n(Ta),Fa=n(919);function Aa(){var e=Object(xe.a)(["\n    mutation MakeUnavailable($formIds:[String]!,$surveyors:[String]!){\n        makeFormsUnavailableFor(formIds:$formIds, surveyorEmails:$surveyors){\n            message\n        }\n    }\n"]);return Aa=function(){return e},e}function xa(){var e=Object(xe.a)(["\n    mutation MakeAvailable($formIds:[String]!,$surveyors:[String]!){\n        makeFormsAvailableFor(formIds:$formIds, surveyorEmails:$surveyors){\n            message\n        }\n    }\n"]);return xa=function(){return e},e}function qa(){var e=Object(xe.a)(["\n    query($ids: [String]){\n        forms(id: $ids){\n          name\n          assignedTo{\n              _id\n              email\n             \n          }\n        }\n      } \n"]);return qa=function(){return e},e}function Ra(){var e=Object(xe.a)(["query{\n    users{\n      _id\n      firstName\n      lastName\n      email\n      accountType\n      availableForms{\n        id\n        name\n      }\n    }\n  }"]);return Ra=function(){return e},e}var Da=Qe()(Ra()),Ma=Qe()(qa()),Ga=Qe()(xa()),Pa=Qe()(Aa());function Va(e){var t=Object(a.useState)([]),n=Object(b.a)(t,2),r=n[0],i=n[1],l=Object(a.useState)([]),s=Object(b.a)(l,2),c=s[0],u=s[1],d=Object(We.b)(Da,{}),p=d.data,m=(d.error,d.loading),h=Object(We.b)(Ma,{variables:{ids:[e.formId]},onCompleted:function(e){u(e.forms[0]?e.forms[0].assignedTo.map((function(e){return e.email})):[]),i(e.forms[0]?e.forms[0].assignedTo.map((function(e){return e.email})):[])}}),f=h.data,v=(h.error,h.loading),g=Object(We.a)(Ga),y=Object(b.a)(g,1)[0],E=Object(We.a)(Pa),C=Object(b.a)(E,1)[0];return o.a.createElement(x.a,{visible:e.visible,onCancel:function(){e.onCancel&&e.onCancel()},onOk:function(){var t,n,a,o;return ke.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:t=r,n=[],c.forEach((function(e){t.includes(e)||n.push(e)})),a=y({variables:{formIds:[e.formId],surveyors:t}}),o=C({variables:{formIds:[e.formId],surveyors:n}}),Promise.all([a,o]).then((function(t){Re.a.success("Sucessfully made changes."),e.onOk&&e.onOk()})).catch((function(e){Re.a.error("Something went wrong, please try again later.")}));case 6:case"end":return i.stop()}}))}},o.a.createElement(Xe.a,{spinning:m||v},o.a.createElement(Fa.a,{titles:["All Users","Available To"],dataSource:f&&p?p.users.filter((function(e){return"surveyor"===e.accountType})).map((function(e){return{key:e.email,title:e.firstName+" "+e.lastName,email:e.email}})):[],targetKeys:r,onChange:function(e){i(e)},render:function(e){return o.a.createElement(kn.a,{placement:"top",title:e.email},o.a.createElement(Ve.a.Text,null,e.title))}})))}var La=function(e){var t=Object(a.useState)(null),n=Object(b.a)(t,2),r=n[0],i=n[1],l=Object(We.a)(fn),s=Object(b.a)(l,2),c=s[0],u=(s[1].data,Object(a.useState)("")),d=Object(b.a)(u,2),p=(d[0],d[1]);return o.a.createElement(x.a,{destroyOnClose:!0,centered:!0,okText:"Create",title:"Create New Form",onCancel:function(){i(""),e.onCancel&&e.onCancel()},onOk:function(){var t,n,a,o,l;return ke.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return(t=r)||p("Form Name cannot be empty"),n=(new Ne).setName(t),(a=Ne.toJSON(n)).content=JSON.stringify(a.content),s.next=7,ke.a.awrap(c({variables:{saveFile:a}}));case 7:if(o=s.sent,l=o.errors,o.data,!l){s.next=13;break}return e.onCreationFailed&&e.onCreationFailed(l),s.abrupt("return");case 13:i(""),e.onCreationSuccess&&e.onCreationSuccess(n.id);case 15:case"end":return s.stop()}}))},visible:e.isOpen},o.a.createElement(Me.a.Item,{label:"Form Name"},o.a.createElement(Ge.a,{onChange:function(e){return i(e.currentTarget.value)}})))};function Qa(){var e=Object(xe.a)(["\n      mutation($formIds: [String]!){\n          deleteForm(id:$formIds){\n              message\n          }\n      }\n"]);return Qa=function(){return e},e}function Ua(){var e=Object(xe.a)(["\n    query{\n        forms{\n          id\n          name\n          createdAt\n          updatedAt\n          assignedTo{\n              _id\n              firstName\n              lastName\n          }\n        }\n      } \n\n"]);return Ua=function(){return e},e}var _a=Qe()(Ua()),Ba=Qe()(Qa());function Ja(e){return o.a.createElement(un.a,{image:un.a.PRESENTED_IMAGE_DEFAULT,description:o.a.createElement("span",null,"No Forms found!")},o.a.createElement(Pe.a,{onClick:e.onCreateClick,type:"primary"},"Create Form"))}var $a=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Statisctics"))}}]),t}(a.Component),Ha=n(915);n(864);function Ka(){var e=Object(xe.a)(["mutation(\n    $email: String!\n    $firstName: String!\n    $lastName: String!\n    $password: String!\n    $createdBy: String!\n  ) {\n    register(\n      user: {\n        email: $email\n        firstName: $firstName\n        lastName: $lastName\n        password: $password\n        accountType: "," \n        createdBy: $createdBy\n      }\n    ) {\n      _id\n    }\n  }\n  "]);return Ka=function(){return e},e}var za=function(e){return Qe()(Ka(),e)};var Ya=function(e){var t=e.input,n=e.label,a=e.type,r=e.meta,i=r.touched,l=r.error,s=r.warning;return o.a.createElement(Me.a.Item,null,o.a.createElement(Ge.a,Object.assign({placeholder:n,autoComplete:"autocomplete_off_hack_xfr4!k"},t,{type:a})),i&&(l&&o.a.createElement("span",{style:{color:"red",top:0,bottom:0}},l)||s&&o.a.createElement("span",null,s)))};var Za=Object(f.b)((function(e,t){return{userId:e.user.id}}),null)((function(e){var t=Object(We.a)(za(e.signUpType),{errorPolicy:"none"}),n=Object(b.a)(t,2),a=n[0],r=(n[1],e.handleSubmit),i=(e.pristine,e.reset,e.submitting);return o.a.createElement(Ie.a,null,o.a.createElement(Xe.a,{spinning:i},o.a.createElement("form",{onSubmit:r((function(t){var n;return ke.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=Object(B.a)({},t,{createdBy:e.userId}),o.abrupt("return",a({variables:n}).then((function(e){return Re.a.success("".concat(n.firstName," has been signed up!")),!0})).catch((function(e){throw new Sn.a({_error:e.message.split(":")[1]})})));case 2:case"end":return o.stop()}}))}))},o.a.createElement(Tn.a,{name:"firstName",label:"First Name",type:"text",component:Ya}),o.a.createElement(Tn.a,{name:"lastName",type:"text",label:"Last Name",component:Ya}),o.a.createElement(Tn.a,{name:"email",component:Ya,type:"text",label:"Email Address"}),o.a.createElement(Tn.a,{name:"password",label:"Password",type:"password",component:Ya}),e.error&&o.a.createElement("strong",{className:"error"},e.error),o.a.createElement(Pe.a,{style:{width:"100%"},disabled:i,htmlType:"submit",icon:"user-add"},"Submit"))))})),Wa=Object(On.a)({form:"signUpUser",validate:function(e){var t={};return e.firstName?e.firstName.length<2&&(t.firstName="Must be 2 characters or more"):t.firstName="Required",e.lastName||(t.lastName="Required"),e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",t},asyncBlurFields:["firstName","lastName","email","password"]})(Za);function Xa(){var e=Object(xe.a)(["query{\n    users{\n      _id\n      firstName\n      lastName\n      email\n      accountType\n      filledForms{\n        id\n        \n      }\n      createdForms{\n        id\n        name\n      }\n      availableForms{\n        id\n        name\n      }\n    }\n  }"]);return Xa=function(){return e},e}var eo,to,no=Ve.a.Paragraph,ao=Qe()(Xa());!function(e){e.ADMIN="admin",e.SURVEYOR="surveyor"}(eo||(eo={})),function(e){e.ADMIN="admin",e.SURVEYOR="surveyor",e.ALL="all"}(to||(to={}));var oo=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={selectedTab:eo.SURVEYOR,signUpType:eo.SURVEYOR,isSignUpDialogOpen:!1,filterType:to.ALL},n.handleTabChange=function(e){n.setState({selectedTab:e})},n.toggleSignUpDialog=function(){n.setState((function(e){return{isSignUpDialogOpen:!e.isSignUpDialogOpen}}))},n.handleAddUserClick=function(e){n.setState({signUpType:e},(function(){n.toggleSignUpDialog()}))},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getAddUserButton",value:function(){return o.a.createElement(Pe.a,{onClick:this.toggleSignUpDialog,icon:"user"},"admin"===this.state.selectedTab?"Add Admin":"Add Surveyor")}},{key:"filterUsersByType",value:function(e){this.setState({filterType:e})}},{key:"render",value:function(){var e=this;return o.a.createElement(Ie.a,{style:{width:"100%",height:"100%"}},o.a.createElement(Te.a,{title:"Users",style:{border:"1px solid rgb(235, 237, 240)"},subTitle:"",extra:[o.a.createElement(Pe.a,{onClick:function(){return e.handleAddUserClick(eo.SURVEYOR)},icon:"user-add",type:"primary",key:"3"},"Add Surveyor"),o.a.createElement(Pe.a,{onClick:function(){return e.handleAddUserClick(eo.ADMIN)},icon:"user-add",type:"primary",key:"2"},"Add Admin")],avatar:{src:"https://avatars1.githubusercontent.com/u/8186664?s=460&v=4"}},o.a.createElement("div",null,this.Content)),o.a.createElement(o.a.Fragment,null,o.a.createElement(ro,{filterUsersByType:this.state.filterType})),o.a.createElement(x.a,{centered:!0,destroyOnClose:!0,onCancel:this.toggleSignUpDialog,visible:this.state.isSignUpDialogOpen,title:"Create ".concat(this.state.selectedTab)},o.a.createElement(Wa,{signUpType:this.state.signUpType})))}},{key:"Content",get:function(){return o.a.createElement("div",{className:"user-content"},o.a.createElement(no,null,"Create surveyor and assign them the forms you created."),o.a.createElement(no,null,"Or create admin users who can collaborate with you on creating forms and managing the collected data."),o.a.createElement(dn.a,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},o.a.createElement(wa.a,{span:12},o.a.createElement(Ge.a.Search,{type:"",size:"large",placeholder:"Find Users..."}))))}}]),t}(a.Component);function ro(e){var t=Object(We.b)(ao,{pollInterval:2e3}),n=t.loading,a=t.data,r=(t.error,[{key:"name",title:"Name",dataIndex:"name",sorter:function(e,t){return e.name.length-t.name.length},ellipsis:!0},{key:"email",title:"Email",dataIndex:"email",sorter:function(e,t){return e.name.length-t.name.length},filteredValue:[e.filterUsersByType]},{key:"role",title:"Role",dataIndex:"role",filters:[{text:"Admins",value:"admin"},{text:"Surveyors",value:"surveyor"}],onFilter:function(e,t){return t.role.includes(e)}},{key:"filledforms",title:"Filled Forms",dataIndex:"filledFormsCount"},{key:"assignedForms",title:"Assigned Forms",dataIndex:"assignedForms",render:function(e,t,n){return o.a.createElement("span",{key:"assignedForms"+n},e.map((function(e){return o.a.createElement(Ia.a,{key:e.id,title:e.name},e.name)})))}}]);return function(){var e=[];return a&&a.users&&(e=a.users.map((function(e){return{name:e.firstName+" "+e.lastName,email:e.email,filledFormsCount:e.filledForms.length,assignedForms:e.availableForms,role:e.accountType}}))),o.a.createElement(Xe.a,{spinning:n},o.a.createElement(Ha.a,{pagination:{pageSize:50},scroll:{y:400},key:"surveyorstable",rowKey:function(e){return e._id},columns:r,dataSource:e}))}()}var io=n(923),lo=n(286),so=n(2),co=n.n(so),uo=io.a.TreeNode,po=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).renderTreeNode=function(e){return"question"===e._type?o.a.createElement(uo,{className:co()("tree-question-node","c-tree-node"),icon:o.a.createElement(q.a,{type:"form"}),title:o.a.createElement(Ve.a.Text,{ellipsis:!0},e.questionContent.content),key:e.id}):e.childNodes?o.a.createElement(uo,{className:"c-tree-node",title:o.a.createElement(Ve.a.Text,{ellipsis:!0},e.name),key:e.id},e.childNodes.map((function(e){return n.renderTreeNode(n.props.tree[e])}))):void 0},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tree,n=e.rootId;return o.a.createElement(Ie.a,null,o.a.createElement(io.a,{showLine:!0,switcherIcon:o.a.createElement(q.a,{type:"down"}),defaultExpandAll:!0,onSelect:this.props.onSelect},this.renderTreeNode(t[n])))}}]),t}(a.Component),mo=(E.a.Header,E.a.Footer),ho=(E.a.Sider,E.a.Content,io.a.TreeNode,{name:"Root",id:ye("root-"),childNodes:[],_type:"root"}),fo=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={selectedNode:null,tree:Object(pt.a)({},ho.id,ho),rootId:ho.id,currentSectionId:ho.id},n.onSelect=function(e){console.log(e)},n.handleActionMenuItemClick=function(e){var t=e.key;if("add-section"===t){var a={_type:"section",appearingCondition:void 0,childNodes:[],customId:void 0,id:ye("section-"),duplicatingSettings:void 0,name:""};n.props.handleAddItemInForm&&n.props.handleAddItemInForm(n.props.formId,a,n.state.currentSectionId)}else if("add-question"===t)ye("root-")},n.renderMenu=o.a.createElement(C.a,{onClick:n.handleActionMenuItemClick},o.a.createElement(C.a.Item,{key:"add-section"},"Section"),o.a.createElement(C.a.Item,{key:"add-question"},"Question")),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement(Ie.a,null,o.a.createElement(dn.a,null,o.a.createElement(dn.a,{type:"flex",style:{padding:20,minHeight:50}},o.a.createElement(wa.a,{span:6},o.a.createElement("div",{style:{padding:"0px 12px",display:"flex",justifyContent:"space-between"}},o.a.createElement(lo.a,{overlay:this.renderMenu},o.a.createElement(Pe.a,null,"Add ",o.a.createElement(q.a,{type:"down"}))),o.a.createElement(Pe.a,{type:"danger",icon:"delete"}))),o.a.createElement(wa.a,{span:18},"content header")),o.a.createElement(dn.a,{style:{minHeight:700,padding:20}},o.a.createElement(wa.a,{span:6},o.a.createElement(po,{tree:this.state.tree,rootId:this.state.rootId,onSelect:function(){console.log("clicked")}}),o.a.createElement(we.a,{type:"vertical"})),o.a.createElement(wa.a,{span:18},"content"))),o.a.createElement(mo,null,"Stats"))}}]),t}(o.a.Component),vo=[{title:"Forms",routeKey:"/forms",icon:"form",component:o.a.createElement((function(e){var t=Object(We.b)(_a,{pollInterval:1e3}),n=t.loading,r=t.error,i=t.data,l=Object(We.a)(Ba),s=Object(b.a)(l,2),c=s[0],u=(s[1].data,Object(a.useState)(!1)),d=Object(b.a)(u,2),p=d[0],m=d[1],h=Object(a.useState)(null),f=Object(b.a)(h,2),g=f[0],y=f[1],E=o.a.createElement("div",{className:"form-content"},o.a.createElement(ja.a,null,"Manage your forms and assign or unassign to your surveyors."),o.a.createElement(ja.a,null),o.a.createElement(dn.a,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},o.a.createElement(wa.a,{span:12},o.a.createElement(Ge.a.Search,{type:"",size:"large",placeholder:"Find Users..."}))));return n||!r&&i&&0!==i.forms.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(Va,{onOk:function(){return y(null)},onCancel:function(){return y(null)},formId:g,visible:!!g}),o.a.createElement(La,{onCancel:function(){return m(!1)},isOpen:p,onCreationSuccess:function(){m(!1)}}),o.a.createElement(Ie.a,null,o.a.createElement(Te.a,{title:"Forms",style:{border:"1px solid rgb(235, 237, 240)"},subTitle:"",extra:[o.a.createElement(Pe.a,{onClick:function(){return m(!0)},icon:"file",type:"primary",key:"3"},"Create Form")],avatar:{icon:"file"}},o.a.createElement("div",null,E)),o.a.createElement(et.a,{loading:n,itemLayout:"horizontal",dataSource:i&&i.forms||[],renderItem:function(e){return o.a.createElement(et.a.Item,{actions:[o.a.createElement(Pe.a,{onClick:function(){y(e.id)},type:"primary",icon:"user-add",key:"add-user"}),o.a.createElement(tt.a,{placement:"left",arrowPointAtCenter:!0,title:"Are you sure you want to delete this form?",onCancel:function(){},onConfirm:function(){return function(e){var t;return ke.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ke.a.awrap(c({variables:{formIds:e}}));case 2:(t=n.sent).data,t.errors?Re.a.error("Could not delete the form file, try again later!"):Re.a.success("Successfully deleted!");case 6:case"end":return n.stop()}}))}([e.id])}},o.a.createElement(Pe.a,{type:"danger",icon:"delete",key:"delete"}))]},o.a.createElement(nt.a,{loading:n,active:!0,avatar:!0},o.a.createElement(et.a.Item.Meta,{avatar:o.a.createElement(at.a,{shape:"square",size:64,icon:"file-text"}),title:o.a.createElement(v.b,{to:"/formbuilder?id=".concat(e.id)},e.name),description:new Date(parseInt(e.updatedAt)).toLocaleTimeString()}),o.a.createElement("div",null,e.assignedTo.map((function(e){return o.a.createElement(Ia.a,{key:e._id},e.firstName+" "+e.lastName)})))))}}))):o.a.createElement(Ja,{onCreateClick:function(){return m(!0)}})}),null),children:[]},{title:"Surveyors",routeKey:"/surveyors",icon:"user",component:o.a.createElement(oo,null),children:[]},{title:"Statistics",routeKey:"/statistics",icon:"pie-chart",component:o.a.createElement($a,null),children:[]},{title:"Form Builder",routeKey:"/formbuilder",hideOnSidebar:!0,icon:"form",children:[],component:o.a.createElement((function(){var e=new URLSearchParams(Object(g.h)().search),t=Object(We.a)(fn),n=Object(b.a)(t,2),r=n[0],i=(n[1].data,Object(a.useState)(!1)),l=Object(b.a)(i,2),s=l[0],c=l[1],u=Object(g.g)(),d=function(e){var t,n;return ke.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(s){a.next=11;break}return(t=Ne.toJSON(e)).content=JSON.stringify(t.content),c(!0),a.next=6,ke.a.awrap(r({variables:{saveFile:t}}));case 6:n=a.sent,n.data,n.errors?Re.a.error("Form could not be saved"):Re.a.success("Form has been saved"),c(!1);case 11:case"end":return a.stop()}}))},p=e.get("id"),m=Object(We.b)(hn,{variables:{formId:[p]}}),h=m.data,f=m.loading,v=m.error;return o.a.createElement(qe.a,null,(function(e){return o.a.createElement(Xe.a,{spinning:f},function(e){if(!f&&(v||!h))return o.a.createElement(un.a,{image:un.a.PRESENTED_IMAGE_DEFAULT,description:"Please create a new Form by going back to Home"},o.a.createElement(Pe.a,{icon:"home",onClick:function(){return u.replace("/forms")}}," Home"));if(f)return o.a.createElement(dn.a,{style:{marginTop:60}});var t;if(0===h.forms.length)Re.a.success("Started a new form!"),t=new Ne;else{var n=h.forms[0];n.content="string"===typeof n.content?JSON.parse(n.content):n.content,t=Ne.fromJSON(n)}return o.a.createElement(cn,{token:"",onChange:function(){},onSave:d,root:t})}())}))}),null)},{title:"Filled Forms",routeKey:"/filledForms",hideOnSidebar:!1,icon:"form",children:[],component:o.a.createElement((function(e){var t=Object(We.b)(it,{variables:{pagination:{offset:0,limit:5}}}),n=t.data,a=t.loading,r=(t.error,t.fetchMore),i=function(e){var t=e.key,a=e.index,r=e.style,i=n.getFilledForms.forms[a];return i||(i={loading:!0,id:"",updatedAt:"",completedDate:"",filledBy:{}}),i.loading?o.a.createElement(Xe.a,{style:r,key:t}):o.a.createElement(et.a.Item,{key:"li"+t,style:r,actions:[o.a.createElement(tt.a,{placement:"left",arrowPointAtCenter:!0,title:"Are you sure you want to delete this form?",onCancel:function(){},onConfirm:function(){i.id}},o.a.createElement(Pe.a,{type:"danger",icon:"delete",key:"delete"}))]},o.a.createElement(nt.a,{loading:i.loading,avatar:!0},o.a.createElement(et.a.Item.Meta,{avatar:o.a.createElement(at.a,{shape:"square",size:64,icon:"file-text"}),title:o.a.createElement(v.b,{to:"/formviewer?formId=".concat(i.id,"&rootId=").concat(i.formId)},i.id),description:o.a.createElement(je.a,{layout:"vertical",size:"small"},o.a.createElement(je.a.Item,{label:"Surveyor Name"},i.filledBy.firstName+" "+i.filledBy.lastName),o.a.createElement(je.a.Item,{label:"Email"},i.filledBy.email),o.a.createElement(je.a.Item,{label:"Completed Date"},new Date(parseInt(i.completedDate)).toDateString()))})))};return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie.a,null,o.a.createElement(Te.a,{title:"Filled forms",style:{border:"1px solid rgb(235, 237, 240)"},subTitle:"",extra:[],avatar:{icon:"file"}},o.a.createElement("div",null,o.a.createElement(Ve.a.Paragraph,null,"Review submitted forms and make changes to the form if necessary."))),o.a.createElement(Xe.a,{spinning:a},o.a.createElement(ot.b,{isRowLoaded:function(e){var t=e.index;return n&&n.getFilledForms&&!!n.getFilledForms.forms[t]},loadMoreRows:function(){return r({variables:{pagination:{offset:n&&n.getFileldForms?n.getFilledForms.forms.length:0,limit:5}},updateQuery:function(e,t){var n=t.fetchMoreResult;return n?Object(L.a)(e,(function(t){t.getFilledForms.forms=[].concat(Object(Ze.a)(e.getFilledForms.forms),Object(Ze.a)(n.getFilledForms.forms)),t.getFilledForms.totalCount=n.getFilledForms.totalCount})):e}})},rowCount:n&&n.getFilledForms&&n.getFilledForms.totalCount||0},(function(e){var t=e.onRowsRendered,a=e.registerChild;return o.a.createElement(ot.a,{disableHeight:!0},(function(e){var r=e.width;return o.a.createElement(ot.c,{height:600,onRowsRendered:t,ref:a,rowCount:n&&n.getFilledForms&&n.getFilledForms.totalCount||0,rowRenderer:i,width:r,rowHeight:100})}))})))))}),null)},{title:"Manage Database",routeKey:"/database_management",hideOnSidebar:!1,icon:"database",children:[],component:o.a.createElement(Ye,null)},{title:"New Form Builder",routeKey:"/newFormBuilder",hideOnSidebar:!1,icon:"form",children:[],component:o.a.createElement(fo,null)},{title:"Form Builder",routeKey:"/formviewer",hideOnSidebar:!0,icon:"form",children:[],component:o.a.createElement(Na,{renderSectionHeader:function(e,t,n){return"root"===n?null:o.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o.a.createElement(Ae.a,{level:"section"===n?4:3},"".concat(ge(t)," ").concat(e)),o.a.createElement(we.a,{type:"horizontal"}))},renderQuestion:function(e){e.input,e.meta;var t=Object(vn.a)(e,["input","meta"]),n=o.a.createElement("div",null,o.a.createElement("strong",null,ge(t.path)," ",t.title," ",e.isRequired?"*":""));return o.a.createElement(Me.a.Item,{key:"form-item"+e.input.name},n,o.a.createElement(yn,{key:"form-question"+e.input.name,question:t,path:t.path,fieldProps:e}))},renderRootSectionHeader:function(e,t){return console.log(e),o.a.createElement(Ie.a,null,o.a.createElement(Te.a,{title:t,style:{border:"1px solid rgb(235, 237, 240)"},subTitle:"",extra:[],avatar:{icon:"file"}},o.a.createElement("div",null,o.a.createElement(je.a,{title:"Surveyor Information"},o.a.createElement(je.a.Item,{label:"Name"},e.filledBy.firstName+" "+e.filledBy.lastName),o.a.createElement(je.a.Item,{label:"Started Date"},new Date(parseInt("".concat(e.startedDate))).toLocaleDateString()),o.a.createElement(je.a.Item,{label:"Completed Date"},new Date(parseInt("".concat(e.completedDate))).toLocaleDateString())))))}})}],go=C.a.SubMenu;Ve.a.Title;function yo(e){return e.isVisible?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(Ve.a.Title,{ellipsis:!0,style:{color:"white"}},"Datapali")),o.a.createElement(C.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},function e(t){return t.items.map((function(n){return n.hideOnSidebar?null:n.children.length>0?o.a.createElement(go,{key:t.parentRouteKey+n.routeKey,title:n.title},e({parentRouteKey:t.parentRouteKey+n.routeKey,items:n.children})):o.a.createElement(C.a.Item,{key:t.parentRouteKey+n.routeKey},o.a.createElement(q.a,{type:n.icon}),o.a.createElement("span",null,n.title),o.a.createElement(v.b,{to:t.parentRouteKey+n.routeKey}))}))}({parentRouteKey:"",items:vo}))):o.a.createElement(o.a.Fragment,null)}var bo=E.a.Header,Eo=E.a.Footer,Co=E.a.Sider,Oo=E.a.Content;C.a.SubMenu;function So(e){var t=Object(g.h)(),n=Object(a.useState)(!1),r=Object(b.a)(n,2),i=r[0],l=r[1];t.pathname;return o.a.createElement(v.a,null,o.a.createElement(E.a,null,o.a.createElement(Co,{trigger:null,collapsible:!0,collapsed:i},o.a.createElement(yo,{isVisible:!0})),o.a.createElement(E.a,null,o.a.createElement(bo,{style:{background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between"}},o.a.createElement(te,{isSidebarCollapsed:i,setSidebarCollapsed:l})),o.a.createElement(Oo,{style:{padding:16}},function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.forEach((function(t){var r=a+t.routeKey;n.push(o.a.createElement(g.b,{key:t.routeKey,exact:!0,path:r,children:t.component||o.a.createElement("h2",null,t.routeKey)})),t.children.length>0&&e(t.children,n,r)})),n}(vo)),o.a.createElement(Eo,null))))}var ko={serverURL:"https://datapali.com/graphql",localServerURL:"http://localhost:5000/graphql"};var No=Object(f.b)((function(e,t){return{authToken:e.user.token}}),null)((function(e){var t=new h.a({uri:ko.serverURL,request:function(t){t.setContext({headers:{authorization:e.authToken||""}})}});return o.a.createElement(qe.b,{client:t},e.children)})),wo=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showPassword:!1,hasError:!1},n.togglePasswordHide=function(){n.setState((function(e){return{showPassword:!e.showPassword}}))},n.createSubmitFunction=function(e){return function(t){var a=n.props,o=a.handleSubmit,r=a.customSubmit;r&&o(r(e))().then((function(e){n.props.onLoggedIn&&n.props.onLoggedIn(e)})),t.preventDefault()}},n.clearErrors=function(){n.state.hasError&&n.setState({hasError:!1})},n.renderEmailInput=function(e){return o.a.createElement(Ge.a,Object.assign({tabIndex:2,prefix:o.a.createElement(q.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email",type:"email"},e.input))},n.renderPasswordInput=function(e){return o.a.createElement(Ge.a,Object.assign({tabIndex:2,prefix:o.a.createElement(q.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Password",type:n.state.showPassword?"text":"password"},e.input))},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.authToken&&this.props.onLoggedIn&&this.props.onLoggedIn(this.props.authToken)}},{key:"renderPasswordHideButton",value:function(){return o.a.createElement(kn.a,{title:"".concat(this.state.showPassword?"Hide":"Show"," Password")},o.a.createElement(Pe.a,{icon:this.state.showPassword?"eye-open":"eye-off",tabIndex:99,onClick:this.togglePasswordHide}))}},{key:"render",value:function(){var e=this;return o.a.createElement(qe.a,null,(function(t){return o.a.createElement(Ie.a,{className:"login-form"},o.a.createElement("h5",null,"Login"),o.a.createElement("form",{onSubmit:e.createSubmitFunction(t)},o.a.createElement(Me.a.Item,null,o.a.createElement(Tn.a,{name:"email",type:"text",component:e.renderEmailInput})),o.a.createElement(Me.a.Item,null,o.a.createElement(Tn.a,{name:"password",type:"password",component:e.renderPasswordInput})),e.props.error&&o.a.createElement("strong",{className:"error"},"Incorrect email or password"),o.a.createElement(Me.a.Item,null,o.a.createElement(Pe.a,{style:{width:"100%"},type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))))}))}}]),t}(o.a.Component);function Io(){var e=Object(xe.a)(["\n  query Login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        firstName\n        lastName\n        accountType\n        availableForms {\n          name\n          id\n          content\n        }\n        filledForms {\n          id\n          startedDate\n          completedDate\n          formId\n          answerStore\n        }\n      }\n    }\n  }\n"]);return Io=function(){return e},e}var To=Qe()(Io()),jo=Object(f.b)((function(e,t){return{authToken:e.user.token}}),(function(e){return{customSubmit:function(t){return function(n){return ke.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",t.query({query:To,variables:{email:n.email,password:n.password},errorPolicy:"none"}).then((function(t){var n=t.data.login,a={id:n.user._id,token:n.token,availableForms:n.user.availableForms.map((function(e){return e.id})),firstName:n.user.firstName,lastName:n.user.lastName,filledForms:n.user.filledForms.map((function(e){return e.id})),accountType:n.user.accountType,createdForms:n.user.createdForms?n.user.createdForms.map((function(e){return e.id})):[]},o={};n.user.availableForms.forEach((function(e){"string"===typeof e.content&&(e.content=JSON.parse(e.content)),o[e.id]=e.content}));var r={};return n.user.filledForms.forEach((function(e){"string"===typeof e.answerStore&&(e.answerStore=JSON.parse(e.answerStore)),r[e.id]={completedDate:parseInt(e.completedDate),filledBy:e.filledBy,formId:e.formId,id:e.id,startedDate:parseInt(e.startedDate),submitted:!0}})),e(A(a)),n.user.token})).catch((function(e){throw new Sn.a({_error:"Incorrect email or password"})})));case 1:case"end":return a.stop()}}))}}}}))(wo),Fo=Object(On.a)({form:"login",onChange:function(e,t,n){return t(Object(Cn.a)("login"))}})(jo),Ao=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){if(this.props.authToken)return o.a.createElement(g.b,this.props);return o.a.createElement(g.b,Object.assign({},this.props,{component:function(){return o.a.createElement(g.a,{to:{pathname:"/login"}})},render:void 0}))}}]),t}(g.b),xo=Object(f.b)((function(e,t){return{authToken:e.user.token}}),(function(){return{}}))(Ao),qo=new h.a({uri:ko.serverURL}),Ro=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={theme:_.DARK},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"changeTheme",value:function(e){this.setState({theme:e})}},{key:"render",value:function(){return o.a.createElement(v.a,null,o.a.createElement(f.a,{store:X},o.a.createElement(y.a,{onBeforeLift:function(){return console.log(X.getState())},loading:null,persistor:ee},o.a.createElement(No,{client:qo},o.a.createElement(p.b,{locale:m.a},o.a.createElement("div",{className:"main-wrapper "},o.a.createElement(g.d,null,o.a.createElement(g.b,{path:"/login",render:function(e){var t=e.history,n=e.location;return o.a.createElement(Fo,{onLoggedIn:function(){var e=(n.state||{from:{pathname:"/"}}).from;t.replace(e)}})}}),o.a.createElement(g.b,{path:"/"},o.a.createElement(xo,{component:So})))),o.a.createElement("div",{id:"modal-container"}))))))}},{key:"Theme",get:function(){switch(this.state.theme){case _.DARK:return"bp3-dark";case _.LIGHT:return""}}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(Ro,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[534,1,2]]]);